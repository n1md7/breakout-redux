var pn=Object.defineProperty;var yn=(e,t,s)=>t in e?pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var g=(e,t,s)=>(yn(e,typeof t!="symbol"?t+"":t,s),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();var wt=(e=>(e.development="development",e.production="production",e.githubPages="github",e.crazyGames="crazy",e.itchIo="itch",e.unitTest="test",e.e2eTest="e2e",e))(wt||{}),L=(e=>(e[e.Classic=0]="Classic",e[e.Dynamic=1]="Dynamic",e[e.Modern=2]="Modern",e[e.Bonus=3]="Bonus",e[e.Empty=4]="Empty",e))(L||{});class mn{constructor(t){this.mode=t}isDevelopment(){return this.mode===wt.development}isCrazyGames(){return this.mode===wt.crazyGames}isItchIo(){return this.mode===wt.itchIo}isGithubPages(){return this.mode===wt.githubPages}isUnitTest(){return this.mode===wt.unitTest}isE2ETest(){return this.mode===wt.e2eTest}}const Le=new mn("github"),bn=1,wn=.5;let ee=1,ke=0,ci=27,Rt=[],_t=0,Ct=0,Tt=0,qt=0,ss,Zt;const B=(...e)=>console.assert(...e),ae=(e,t=d(),s="#fff",i=0,r=0,n=!1)=>{B(typeof s=="string"),Rt.push({pos:e,size:d(t),color:s,time:new Re(i),angle:r,fill:n})},Rs=(e,t=0,s="#fff",i=0,r=!1)=>{B(typeof s=="string"),Rt.push({pos:e,size:t,color:s,time:new Re(i),angle:0,fill:r})},xn=(e,t,s,i)=>ae(e,0,t,s,i),Sn=(e,t,s,i=.1,r)=>{const n=d((t.x-e.x)/2,(t.y-e.y)/2),a=d(i,n.length()*2);ae(e.add(n),a,s,r,n.angle(),1)},Ns=(e,t,s,i,r)=>{const n=d(it(e.x-t.x/2,s.x-i.x/2),it(e.y-t.y/2,s.y-i.y/2)),a=d(nt(e.x+t.x/2,s.x+i.x/2),nt(e.y+t.y/2,s.y+i.y/2));ae(n.lerp(a,.5),a.subtract(n),r)},vn=(e,t,s=1,i="#fff",r=0,n=0,a="monospace")=>{B(typeof i=="string"),Rt.push({text:e,pos:t,size:s,color:i,time:new Re(r),angle:n,font:a})},_n=(e,t=Cs+".png")=>{Zt.download="screenshot.png",Zt.href=e.toDataURL("image/png").replace("image/png","image/octet-stream"),Zt.click()},Cn=()=>{document.body.appendChild(Zt=document.createElement("a")),Zt.style.display="none"},Tn=()=>{ct(ci)&&(_t=!_t),_t&&(ct(48)&&(ee=!ee),ct(49)&&(Ct=!Ct,Tt=0),ct(50)&&(Tt=!Tt,Ct=0),ct(51)&&(qt=!qt),ct(52)&&(ke=!ke),ct(53)&&(ss=1))},En=()=>{if(_e(Y),ss&&(_e(Y,1),Y.drawImage(lt,0,0),lt.width|=0,_n(x),ss=0),qt&&zn&&navigator.getGamepads){const e=navigator.getGamepads();for(let t=e.length;t--;){const s=e[t];if(s){const n=V,a=ns[t];for(let o=a.length;o--;){const l=n.add(d(o*1*2,t*1*3)),h=l.add(a[o].scale(1));Rs(l,1,"#fff7",0,1),Sn(l,h,"#f00"),xn(h,"#f00")}for(let o=s.buttons.length;o--;){const l=n.add(d(o*.2*2,t*1*3-1-.2)),h=s.buttons[o].pressed;Rs(l,.2,h?"#f00":"#fff7",0,1),vn(o,l,.2)}}}}if(_t){const e=Y;Y=p;let t=1/0,s;for(const i of st){if(i.canvas||i.destroyed||!i.size.x||!i.size.y)continue;const r=ft.distanceSquared(i.pos);r<t&&(t=r,s=i);const n=d(nt(i.size.x,.2),nt(i.size.y,.2)),a=new y(!!i.collideTiles,!!i.collideSolidObjects,!!i.isSolid,i.parent?.2:.5),o=i.parent?new y(1,1,1,.5):new y(0,0,0,.8);vt(i.pos,n,a,i.angle,0),vt(i.pos,n.scale(.8),o,i.angle,0),i.parent&&Gs(i.pos,i.parent.pos,.1,new y(0,0,1,.5),0)}if(s){const i=Kn(s.pos,ft);i&&vt(i.floor().add(d(.5)),d(1),new y(0,1,1,.3)),vt(ft.floor().add(d(.5)),d(1),new y(0,0,1,.5),0,0),Gs(ft,s.pos,.1,i?new y(1,0,0,.5):new y(0,1,0,.5),0);const r="mouse pos = "+ft+`
mouse collision = `+wi(ft)+`

--- object info ---
`+s.toString();Un(r,xs,24,new y,.05,0,0,"monospace")}_e(Y=e)}{p.lineWidth=2;const e=wn*K;Rt.forEach(t=>{p.save();const s=je(t.pos);if(p.translate(s.x|0,s.y|0),p.rotate(t.angle),p.fillStyle=p.strokeStyle=t.color,t.text!=null)p.font=t.size*K+"px "+t.font,p.textAlign="center",p.textBaseline="middle",p.fillText(t.text,0,0);else if(t.size==0||t.size.x===0&&t.size.y===0)p.fillRect(-e/2,-1,e,3),p.fillRect(-1,-e/2,3,e);else if(t.size.x!=null){const i=t.size.x*K|0,r=t.size.y*K|0;t.fill&&p.fillRect(-i/2|0,-r/2|0,i,r),p.strokeRect(-i/2|0,-r/2|0,i,r)}else p.beginPath(),p.arc(0,0,t.size*K,0,9),t.fill&&p.fill(),p.stroke();p.restore()}),Rt=Rt.filter(t=>t.time<0)}{p.save(),p.fillStyle="#fff",p.textAlign="left",p.textBaseline="top",p.font="28px monospace",p.shadowColor="#000",p.shadowBlur=9;let e=9,t=-20,s=30;if(_t){p.fillText(Cs,e,t+=s),p.fillText("Objects: "+st.length,e,t+=s),p.fillText("Time: "+kn(q),e,t+=s),p.fillText("---------",e,t+=s),p.fillStyle="#f00",p.fillText("ESC: Debug Overlay",e,t+=s),p.fillStyle=Ct?"#f00":"#fff",p.fillText("1: Debug Physics",e,t+=s),p.fillStyle=Tt?"#f00":"#fff",p.fillText("2: Debug Particles",e,t+=s),p.fillStyle=qt?"#f00":"#fff",p.fillText("3: Debug Gamepads",e,t+=s),p.fillStyle=ke?"#f00":"#fff",p.fillText("4: God Mode",e,t+=s),p.fillStyle="#fff",p.fillText("5: Save Screenshot",e,t+=s);let i="";for(const n in U[0])n&&se(n,0)&&(i+=n+" ");i&&p.fillText("Keys Down: "+i,e,t+=s);let r="";if(U[1])for(const n in U[1])n&&se(n,1)&&(r+=n+" ");r&&p.fillText("Gamepad: "+r,e,t+=s)}else p.fillText(Ct?"Debug Physics":"",e,t+=s),p.fillText(Tt?"Debug Particles":"",e,t+=s),p.fillText(ke?"God Mode":"",e,t+=s),p.fillText(qt?"Debug Gamepads":"",e,t+=s);p.restore()}},Ae=Math.PI,Z=e=>e<0?-e:e,it=(e,t)=>e<t?e:t,nt=(e,t)=>e>t?e:t,Nt=e=>e<0?-1:1,R=(e,t=0,s=1)=>e<t?t:e>s?s:e,jt=(e,t=0,s=1)=>s-t?R((e-t)/(s-t)):0,Gt=(e,t=0,s=1)=>t+R(e)*(s-t),js=(e,t,s,i)=>Z(e.x-s.x)*2<t.x+i.x&&Z(e.y-s.y)*2<t.y+i.y,kn=e=>(e/60|0)+":"+(e%60<10?"0":"")+(e%60|0),M=(e=1,t=0)=>t+(e-t)*Math.random(),Ht=(e=1,t=0)=>M(e,t)|0,An=()=>Ht(2)*2-1,Dn=(e=1,t=0)=>e>0?hi(e*M(t/e,1)**.5):new C,hi=(e=1)=>new C().setAngle(M(2*Ae),e),Us=(e=new y,t=new y(0,0,0,1),s)=>s?e.lerp(t,M()):new y(M(e.r,t.r),M(e.g,t.g),M(e.b,t.b),M(e.a,t.a)),d=(e=0,t)=>e.x==null?new C(e,t??e):new C(e.x,e.y),tt=e=>!isNaN(e.x)&&!isNaN(e.y);class C{constructor(t=0,s=0){this.x=t,this.y=s}copy(){return new C(this.x,this.y)}add(t){return B(tt(t)),new C(this.x+t.x,this.y+t.y)}subtract(t){return B(tt(t)),new C(this.x-t.x,this.y-t.y)}multiply(t){return B(tt(t)),new C(this.x*t.x,this.y*t.y)}divide(t){return B(tt(t)),new C(this.x/t.x,this.y/t.y)}scale(t){return B(!tt(t)),new C(this.x*t,this.y*t)}length(){return this.lengthSquared()**.5}lengthSquared(){return this.x**2+this.y**2}distance(t){return this.distanceSquared(t)**.5}distanceSquared(t){return(this.x-t.x)**2+(this.y-t.y)**2}normalize(t=1){const s=this.length();return s?this.scale(t/s):new C(0,t)}clampLength(t=1){const s=this.length();return s>t?this.scale(t/s):this}dot(t){return B(tt(t)),this.x*t.x+this.y*t.y}cross(t){return B(tt(t)),this.x*t.y-this.y*t.x}angle(){return Math.atan2(this.x,this.y)}setAngle(t=0,s=1){return this.x=s*Math.sin(t),this.y=s*Math.cos(t),this}rotate(t){const s=Math.cos(t),i=Math.sin(t);return new C(this.x*s-this.y*i,this.x*i+this.y*s)}direction(){return Z(this.x)>Z(this.y)?this.x<0?3:1:this.y<0?2:0}invert(){return new C(this.y,-this.x)}floor(){return new C(Math.floor(this.x),Math.floor(this.y))}area(){return Z(this.x*this.y)}lerp(t,s){return B(tt(t)),this.add(t.subtract(this).scale(R(s)))}arrayCheck(t){return this.x>=0&&this.y>=0&&this.x<t.x&&this.y<t.y}toString(t=3){return`(${(this.x<0?"":" ")+this.x.toFixed(t)},${(this.y<0?"":" ")+this.y.toFixed(t)} )`}}class y{constructor(t=1,s=1,i=1,r=1){this.r=t,this.g=s,this.b=i,this.a=r}copy(){return new y(this.r,this.g,this.b,this.a)}add(t){return new y(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new y(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}multiply(t){return new y(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}divide(t){return new y(this.r/t.r,this.g/t.g,this.b/t.b,this.a/t.a)}scale(t,s=t){return new y(this.r*t,this.g*t,this.b*t,this.a*s)}clamp(){return new y(R(this.r),R(this.g),R(this.b),R(this.a))}lerp(t,s){return this.add(t.subtract(this).scale(R(s)))}setHSLA(t=0,s=0,i=1,r=1){const n=i<.5?i*(1+s):i+s-i*s,a=2*i-n,o=(l,h,c)=>(c=(c%1+1)%1)<1/6?l+(h-l)*6*c:c<1/2?h:c<2/3?l+(h-l)*(2/3-c)*6:l;return this.r=o(a,n,t+1/3),this.g=o(a,n,t),this.b=o(a,n,t-1/3),this.a=r,this}getHSLA(){const t=R(this.r),s=R(this.g),i=R(this.b),r=R(this.a),n=Math.max(t,s,i),a=Math.min(t,s,i),o=(n+a)/2;let l=0,h=0;if(n!=a){let c=n-a;h=o>.5?c/(2-n-a):c/(n+a),t==n?l=(s-i)/c+(s<i?6:0):s==n?l=(i-t)/c+2:i==n&&(l=(t-s)/c+4)}return[l/6,h,o,r]}mutate(t=.05,s=0){return new y(this.r+M(t,-t),this.g+M(t,-t),this.b+M(t,-t),this.a+M(s,-s)).clamp()}toString(t=1){const s=i=>((i=i*255|0)<16?"0":"")+i.toString(16);return"#"+s(this.r)+s(this.g)+s(this.b)+(t?s(this.a):"")}setHex(t){const s=i=>R(parseInt(t.slice(i,i+2),16)/255);return this.r=s(1),this.g=s(3),this.b=s(5),this.a=t.length>7?s(7):1,this}rgbaInt(){const t=a=>R(a)*255|0,s=t(this.r),i=t(this.g)<<8,r=t(this.b)<<16,n=t(this.a)<<24;return s+i+r+n}}class Re{constructor(t){this.time=t==null?void 0:q+t,this.setTime=t}set(t=0){this.time=q+t,this.setTime=t}unset(){this.time=void 0}isSet(){return this.time!=null}active(){return q<=this.time}elapsed(){return q>this.time}get(){return this.isSet()?q-this.time:0}getPercent(){return this.isSet()?jt(this.time-q,this.setTime,0):0}toString(){return this.unset()?"unset":Math.abs(this.get())+" seconds "+(this.get()<0?"before":"after")}valueOf(){return this.get()}}let V=d(),K=32,Fs=d(1920,1200),Se=d(),ui=1,Pn="arial",di=1,Ne=d(16),Vt=.3,Mn=1,$n=1,On=1,Bn=0,In=.8,ge=1,pe=0,Hs=1,zn=1,Jt=1,fi=.5,Ln=40,Rn=.7,Ws=5,ye=.5;d(640,80);class Pt{constructor(t=d(),s=d(1),i=-1,r=Ne,n=0,a,o=0){B(tt(t)&&tt(s)),this.pos=t.copy(),this.size=s,this.drawSize,this.tileIndex=i,this.tileSize=r,this.angle=n,this.color=a,this.additiveColor,this.mass=Mn,this.damping=$n,this.angleDamping=On,this.elasticity=Bn,this.friction=In,this.gravityScale=1,this.renderOrder=o,this.velocity=new C,this.angleVelocity=0,this.spawnTime=q,this.children=[],this.collideTiles=1,st.push(this)}update(){const t=this.parent;if(t){this.pos=this.localPos.multiply(d(t.getMirrorSign(),1)).rotate(-t.angle).add(t.pos),this.angle=t.getMirrorSign()*this.localAngle+t.angle;return}this.velocity.x=R(this.velocity.x,-ge,ge),this.velocity.y=R(this.velocity.y,-ge,ge);const s=this.pos.copy();if(this.velocity.y+=pe*this.gravityScale,this.pos.x+=this.velocity.x*=this.damping,this.pos.y+=this.velocity.y*=this.damping,this.angle+=this.angleVelocity*=this.angleDamping,B(this.angleDamping>=0&&this.angleDamping<=1),B(this.damping>=0&&this.damping<=1),!this.mass)return;const i=this.velocity.y<0;if(this.groundObject){const r=this.groundObject.velocity?this.groundObject.velocity.x:0;this.velocity.x=r+(this.velocity.x-r)*this.friction,this.groundObject=0}if(this.collideSolidObjects)for(const n of Di){if(!this.isSolid&!n.isSolid||n.destroyed||n.parent||n==this||!js(this.pos,this.size,n.pos,n.size)||!this.collideWithObject(n)|!n.collideWithObject(this))continue;if(js(s,this.size,n.pos,n.size)){const u=s.subtract(n.pos),f=u.length(),m=.001,b=f<.01?hi(m):u.scale(m/f);this.velocity=this.velocity.add(b),n.mass&&(n.velocity=n.velocity.subtract(b)),_t&&Ct&&Ns(this.pos,this.size,n.pos,n.size,"#f00");continue}const a=this.size.add(n.size),o=(s.y-n.pos.y)*2>a.y+pe,l=Z(s.y-n.pos.y)*2<a.y,h=Z(s.x-n.pos.x)*2<a.x,c=nt(this.elasticity,n.elasticity);if(o|h|!l){if(this.pos.y=n.pos.y+(a.y/2+.001)*Nt(s.y-n.pos.y),n.groundObject&&i||!n.mass)i&&(this.groundObject=n),this.velocity.y*=-c;else if(n.mass){const u=(this.mass*this.velocity.y+n.mass*n.velocity.y)/(this.mass+n.mass),f=this.velocity.y*(this.mass-n.mass)/(this.mass+n.mass)+n.velocity.y*2*n.mass/(this.mass+n.mass),m=n.velocity.y*(n.mass-this.mass)/(this.mass+n.mass)+this.velocity.y*2*this.mass/(this.mass+n.mass);this.velocity.y=Gt(c,u,f),n.velocity.y=Gt(c,u,m)}}if(!o&l)if(this.pos.x=n.pos.x+(a.x/2+.001)*Nt(s.x-n.pos.x),n.mass){const u=(this.mass*this.velocity.x+n.mass*n.velocity.x)/(this.mass+n.mass),f=this.velocity.x*(this.mass-n.mass)/(this.mass+n.mass)+n.velocity.x*2*n.mass/(this.mass+n.mass),m=n.velocity.x*(n.mass-this.mass)/(this.mass+n.mass)+this.velocity.x*2*this.mass/(this.mass+n.mass);this.velocity.x=Gt(c,u,f),n.velocity.x=Gt(c,u,m)}else this.velocity.x*=-c;_t&&Ct&&Ns(this.pos,this.size,n.pos,n.size,"#f0f")}if(this.collideTiles&&be(this.pos,this.size,this)&&!be(s,this.size,this)){const r=be(new C(s.x,this.pos.y),this.size,this),n=be(new C(this.pos.x,s.y),this.size,this);if(r|!n){this.groundObject=i,this.velocity.y*=-this.elasticity;const a=(s.y-this.size.y/2|0)-(s.y-this.size.y/2);a<0&&a>this.damping*this.velocity.y+pe*this.gravityScale&&(this.velocity.y=this.damping?(a-pe*this.gravityScale)/this.damping:0),this.pos.y=s.y}n&&(this.pos.x=s.x,this.velocity.x*=-this.elasticity)}}render(){De(this.pos,this.drawSize||this.size,this.tileIndex,this.tileSize,this.color,this.angle,this.mirror,this.additiveColor)}destroy(){if(!this.destroyed){this.destroyed=1,this.parent&&this.parent.removeChild(this);for(const t of this.children)t.destroy(t.parent=0)}}collideWithTile(t,s){return t>0}collideWithTileRaycast(t,s){return t>0}collideWithObject(t){return 1}getAliveTime(){return q-this.spawnTime}applyAcceleration(t){this.mass&&(this.velocity=this.velocity.add(t))}applyForce(t){this.applyAcceleration(t.scale(1/this.mass))}getMirrorSign(){return this.mirror?-1:1}addChild(t,s=d(),i=0){B(!t.parent&&!this.children.includes(t)),this.children.push(t),t.parent=this,t.localPos=s.copy(),t.localAngle=i}removeChild(t){B(t.parent==this&&this.children.includes(t)),this.children.splice(this.children.indexOf(t),1),t.parent=0}setCollision(t=1,s=1,i=1){B(t||!s),this.collideSolidObjects=t,this.isSolid=s,this.collideTiles=i}toString(){{let t="type = "+this.constructor.name;return(this.pos.x||this.pos.y)&&(t+=`
pos = `+this.pos),(this.velocity.x||this.velocity.y)&&(t+=`
velocity = `+this.velocity),(this.size.x||this.size.y)&&(t+=`
size = `+this.size),this.angle&&(t+=`
angle = `+this.angle.toFixed(3)),this.color&&(t+=`
color = `+this.color),t}}}let x,Y,lt,p,pt=d();const et=new Image;let Xt,Kt,is;const Nn=e=>(B(pt.x&&pt.y,"mainCanvasSize is invalid"),e.add(d(.5)).subtract(pt.scale(.5)).multiply(d(1/K,-1/K)).add(V)),je=e=>(B(pt.x&&pt.y,"mainCanvasSize is invalid"),e.subtract(V).multiply(d(K,-K)).add(pt.scale(.5)).subtract(d(.5)));function De(e,t=d(1),s=-1,i=Ne,r=new y,n=0,a,o=new y(0,0,0,0),l=di){if(ee&&++is,l)if(s<0||!et.width)Ys(e.x,e.y,t.x,t.y,n,0,0,0,0,0,r.rgbaInt());else{const h=Xt.x/i.x|0,c=i.x/Xt.x,u=i.y/Xt.y,f=s%h*c,m=(s/h|0)*u;Ys(e.x,e.y,a?-t.x:t.x,t.y,n,f+Kt.x,m+Kt.y,f-Kt.x+c,m-Kt.y+u,r.rgbaInt(),o.rgbaInt())}else jn(e,t,n,a,h=>{if(s<0)h.fillStyle=r,h.fillRect(-.5,-.5,1,1);else{const c=Xt.x/i.x|0,u=s%c*i.x+Vt,f=(s/c|0)*i.y+Vt,m=i.x-2*Vt,b=i.y-2*Vt;h.globalAlpha=r.a,h.drawImage(et,u,f,m,b,-.5,-.5,1,1)}})}function vt(e,t,s,i,r){De(e,t,-1,Ne,s,i,0,0,r)}function Gs(e,t,s=.1,i,r){const n=d((t.x-e.x)/2,(t.y-e.y)/2),a=d(s,n.length()*2);vt(e.add(n),a,i,n.angle(),r)}function jn(e,t,s,i,r,n=Y){e=je(e),t=t.scale(K),n.save(),n.translate(e.x+.5|0,e.y+.5|0),n.rotate(s),n.scale(i?-t.x:t.x,t.y),r(n),n.restore()}function Vs(e,t=di){t?vi(e):Y.globalCompositeOperation=e?"lighter":"source-over"}function Un(e,t,s=1,i=new y,r=0,n=new y(0,0,0),a="center",o=Pn,l=p){l.fillStyle=i,l.lineWidth=r,l.strokeStyle=n,l.textAlign=a,l.font=s+"px "+o,l.textBaseline="middle",l.lineJoin="round",t=t.copy(),(e+"").split(`
`).forEach(h=>{r&&l.strokeText(h,t.x,t.y),l.fillText(h,t.x,t.y),t.y+=s})}let Xe;class Ke{constructor(t,s=d(8),i=d(0,1),r=0,n=p){Xe||((Xe=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAYAQAAAAA9+x6JAAAAAnRSTlMAAHaTzTgAAAGiSURBVHjaZZABhxxBEIUf6ECLBdFY+Q0PMNgf0yCgsSAGZcT9sgIPtBWwIA5wgAPEoHUyJeeSlW+gjK+fegWwtROWpVQEyWh2npdpBmTUFVhb29RINgLIukoXr5LIAvYQ5ve+1FqWEMqNKTX3FAJHyQDRZvmKWubAACcv5z5Gtg2oyCWE+Yk/8JZQX1jTTCpKAFGIgza+dJCNBF2UskRlsgwitHbSV0QLgt9sTPtsRlvJjEr8C/FARWA2bJ/TtJ7lko34dNDn6usJUMzuErP89UUBJbWeozrwLLncXczd508deAjLWipLO4Q5XGPcJvPu92cNDaN0P5G1FL0nSOzddZOrJ6rNhbXGmeDvO3TF7DeJWl4bvaYQTNHCTeuqKZmbjHaSOFes+IX/+IhHrnAkXOAsfn24EM68XieIECoccD4KZLk/odiwzeo2rovYdhvb2HYFgyznJyDpYJdYOmfXgVdJTaUi4xA2uWYNYec9BLeqdl9EsoTw582mSFDX2DxVLbNt9U3YYoeatBad1c2Tj8t2akrjaIGJNywKB/7h75/gN3vCMSaadIUTAAAAAElFTkSuQmCC"),this.image=t||Xe,this.tileSize=s,this.paddingSize=i,this.startTileIndex=r,this.context=n}drawTextScreen(t,s,i=4,r){const n=this.context;n.save(),n.imageSmoothingEnabled=!ui;const a=this.tileSize,o=a.add(this.paddingSize).scale(i),l=this.image.width/this.tileSize.x|0;(t+"").split(`
`).forEach((h,c)=>{const u=r?h.length*a.x*i/2|0:0;for(let f=h.length;f--;){let m=h[f].charCodeAt();(m<32||m>127)&&(m=127);const b=this.startTileIndex+m-32,A=b%l,D=b/l|0,E=s.add(d(f,c).multiply(o));n.drawImage(this.image,A*a.x,D*a.y,a.x,a.y,E.x-u,E.y,a.x*i,a.y*i)}}),n.restore()}drawText(t,s,i=1,r){this.drawTextScreen(t,je(s).floor(),i*K|0,r)}}const se=(e,t=0)=>U[t]&&U[t][e]&1,ct=(e,t=0)=>U[t]&&U[t][e]&2?1:0,Fn=()=>U=[[]],ws=ct;let ft=d(),xs=d(),Ss=0;const Ot=(e,t=0)=>se(e,t+1),vs=(e,t=0)=>ct(e,t+1);let U=[[]];function Hn(){pi||document.hasFocus()||Fn(),ft=Nn(xs),Vn()}function Wn(){for(const e of U)for(const t in e)e[t]&=1}onkeydown=e=>{e.target==document.body&&(e.repeat||(U[Ss=0][gi(e.which)]=3))};onkeyup=e=>{e.target==document.body&&(U[0][gi(e.which)]=4)};const gi=e=>e==87?38:e==83?40:e==65?37:e==68?39:e;onmousedown=e=>{U[Ss=0][e.button]=3,onmousemove(e),e.button&&e.preventDefault()};onmouseup=e=>U[0][e.button]=U[0][e.button]&2|4;onmousemove=e=>xs=Gn(e);onwheel=e=>e.ctrlKey||Nt(e.deltaY);oncontextmenu=e=>!1;const Gn=e=>{if(!x)return d();const t=x.getBoundingClientRect();return d(x.width,x.height).multiply(d(jt(e.x,t.left,t.right),jt(e.y,t.top,t.bottom)))},ns=[];function Vn(){if(!navigator||!navigator.getGamepads||!document.hasFocus()&&!bn)return;const e=navigator.getGamepads();for(let t=e.length;t--;){const s=e[t],i=U[t+1]||(U[t+1]=[]),r=ns[t]||(ns[t]=[]);if(s){const o=l=>l>.3?jt(l,.3,.8):l<-.3?-jt(-l,.3,.8):0;for(let l=0;l<s.axes.length-1;l+=2)r[l>>1]=d(o(s.axes[l]),o(-s.axes[l+1])).clampLength();for(let l=s.buttons.length;l--;){const h=s.buttons[l];i[l]=h.pressed?1+2*!Ot(l,t):4*Ot(l,t),Ss|=!t&&h.pressed}{const l=d(Ot(15,t)-Ot(14,t),Ot(12,t)-Ot(13,t));l.lengthSquared()&&(r[0]=l.clampLength())}}}}const pi=window.ontouchstart!==void 0;if(pi){let e,t=onmousedown,s=onmouseup;onmousedown=onmouseup=()=>0,ontouchstart=i=>(Xn(0),ontouchstart=ontouchmove=ontouchend=r=>{r.button=0;const n=r.touches.length;return n?(r.x=r.touches[0].clientX,r.y=r.touches[0].clientY,e?onmousemove(r):t(r)):e&&s(r),e=n,!0},ontouchstart(i))}new Re;let me=class{constructor(t,s=Ln,i=Rn){Jt&&(this.range=s,this.taper=i,this.randomness=t[1]||0,t[1]=0,this.cachedSamples=mi(...t))}play(t,s=1,i=1,r=1){if(!Jt)return;let n;if(t){const o=this.range;if(o){const l=V.distanceSquared(t);if(l>o*o)return;s*=jt(l**.5,o,o*this.taper)}n=je(t).x*2/x.width-1}const a=i+i*this.randomness*r*M(-1,1);return yi([this.cachedSamples],s,a,n)}playNote(t,s,i){if(Jt)return this.play(s,i,2**(t/12),0)}},ot;function yi(e,t=1,s=1,i=0,r=0){if(!Jt||(ot||(ot=new AudioContext),ot.resume(),ot.state!="running"))return;const n=ot.createBuffer(e.length,e[0].length,X),a=ot.createBufferSource();e.forEach((l,h)=>n.getChannelData(h).set(l)),a.buffer=n,a.playbackRate.value=s,a.loop=r;const o=ot.createGain();return o.gain.value=fi*t,o.connect(ot.destination),a.connect(new StereoPannerNode(ot,{pan:R(i,-1,1)})).connect(o),a.start(),a}const Xn=(...e)=>yi([mi(...e)]),X=44100;function mi(e=1,t=.05,s=220,i=0,r=0,n=.1,a=0,o=1,l=0,h=0,c=0,u=0,f=0,m=0,b=0,A=0,D=0,E=1,_=0,I=0){let k=Ae*2,Q=l*=500*k/X/X,bt=[],de=s*=(1+t*M(-1,1))*k/X,at=0,fe=0,N=0,Mt=1,Ge=0,gn=0,dt=0,Ve,$t;for(i=i*X+9,_*=X,r*=X,n*=X,D*=X,h*=500*k/X**3,b*=k/X,c*=k/X,u*=X,f=f*X|0,$t=i+_+r+n+D|0;N<$t;bt[N++]=dt)++gn%(A*100|0)||(dt=a?a>1?a>2?a>3?Math.sin((at%k)**3):nt(it(Math.tan(at),1),-1):1-(2*at/k%2+2)%2:1-4*Z(Math.round(at/k)-at/k):Math.sin(at),dt=(f?1-I+I*Math.sin(k*N/f):1)*Nt(dt)*Z(dt)**o*e*fi*(N<i?N/i:N<i+_?1-(N-i)/_*(1-E):N<i+_+r?E:N<$t-D?($t-N-D)/n*E:0),dt=D?dt/2+(D>N?0:(N<$t-D?1:($t-N)/D)*bt[N-D|0]/2):dt),Ve=(s+=l+=h)*Math.cos(b*fe++),at+=Ve-Ve*m*(1-(Math.sin(N)+1)*1e9%2),Mt&&++Mt>u&&(s+=c,de+=c,Mt=0),f&&!(++Ge%f)&&(s=de,l=Q,Mt||(Mt=1));return bt}let bi=[],Qt=d();const wi=e=>e.arrayCheck(Qt)?bi[(e.y|0)*Qt.x+e.x|0]:0;function be(e,t=d(),s){const i=nt(e.x-t.x/2|0,0),r=nt(e.y-t.y/2|0,0),n=it(e.x+t.x/2,Qt.x),a=it(e.y+t.y/2,Qt.y);for(let o=r;o<a;++o)for(let l=i;l<n;++l){const h=bi[o*Qt.x+l];if(h&&(!s||s.collideWithTile(h,new C(l,o))))return 1}}function Kn(e,t,s){const i=(t=t.floor()).subtract(e=e.floor()),r=Z(i.x),n=-Z(i.y),a=Nt(i.x),o=Nt(i.y);for(let l=e.x,h=e.y,c=r+n;;){const u=wi(d(l,h));if(u&&(s?s.collideWithTileRaycast(u,new C(l,h)):u>0))return new C(l+.5,h+.5);if(l==t.x&h==t.y)break;const f=2*c;f>=n&&(c+=n,l+=a),f<=r&&(c+=r,h+=o)}}class Xs extends Pt{constructor(t,s,i=0,r=0,n=100,a=Ae,o=-1,l=Ne,h=new y,c=new y,u=new y(1,1,1,0),f=new y(1,1,1,0),m=.5,b=.1,A=1,D=.1,E=.05,_=1,I=1,k=0,Q=Ae,bt=.1,de=.2,at,fe,N=1,Mt=fe?1e9:0,Ge){super(t,new C,o,l,s,void 0,Mt),this.emitSize=i,this.emitTime=r,this.emitRate=n,this.emitConeAngle=a,this.colorStartA=h,this.colorStartB=c,this.colorEndA=u,this.colorEndB=f,this.randomColorLinear=N,this.particleTime=m,this.sizeStart=b,this.sizeEnd=A,this.speed=D,this.angleSpeed=E,this.damping=_,this.angleDamping=I,this.gravityScale=k,this.particleConeAngle=Q,this.fadeRate=bt,this.randomness=de,this.collideTiles=at,this.additive=fe,this.localSpace=Ge,this.trailScale=0,this.emitTimeBuffer=0}update(){if(this.parent&&super.update(),!this.emitTime|this.getAliveTime()<=this.emitTime){if(this.emitRate*Hs){const t=1/this.emitRate/Hs;for(this.emitTimeBuffer+=Ai;this.emitTimeBuffer>0;this.emitTimeBuffer-=t)this.emitParticle()}}else this.destroy();Tt&&ae(this.pos,d(this.emitSize),"#0f0",0,this.angle)}emitParticle(){let t=this.emitSize.x!=null?new C(M(-.5,.5),M(-.5,.5)).multiply(this.emitSize).rotate(this.angle):Dn(this.emitSize/2),s=M(this.particleConeAngle,-this.particleConeAngle);this.localSpace||(t=this.pos.add(t),s+=this.angle);const i=new Yn(t,this.tileIndex,this.tileSize,s),r=this.randomness,n=A=>A+A*M(r,-r),a=n(this.particleTime),o=n(this.sizeStart),l=n(this.sizeEnd),h=n(this.speed),c=n(this.angleSpeed)*An(),u=M(this.emitConeAngle,-this.emitConeAngle),f=Us(this.colorStartA,this.colorStartB,this.randomColorLinear),m=Us(this.colorEndA,this.colorEndB,this.randomColorLinear),b=this.localSpace?u:this.angle+u;return i.colorStart=f,i.colorEndDelta=m.subtract(f),i.velocity=new C().setAngle(b,h),i.angleVelocity=c,i.lifeTime=a,i.sizeStart=o,i.sizeEndDelta=l-o,i.fadeRate=this.fadeRate,i.damping=this.damping,i.angleDamping=this.angleDamping,i.elasticity=this.elasticity,i.friction=this.friction,i.gravityScale=this.gravityScale,i.collideTiles=this.collideTiles,i.additive=this.additive,i.renderOrder=this.renderOrder,i.trailScale=this.trailScale,i.mirror=Ht(2),i.localSpaceEmitter=this.localSpace&&this,i.destroyCallback=this.particleDestroyCallback,this.particleCreateCallback&&this.particleCreateCallback(i),i}render(){}}class Yn extends Pt{constructor(t,s,i,r){super(t,new C,s,i,r)}render(){const t=it((q-this.spawnTime)/this.lifeTime,1),s=this.sizeStart+t*this.sizeEndDelta,i=new C(s,s),r=this.fadeRate/2,n=new y(this.colorStart.r+t*this.colorEndDelta.r,this.colorStart.g+t*this.colorEndDelta.g,this.colorStart.b+t*this.colorEndDelta.b,(this.colorStart.a+t*this.colorEndDelta.a)*(t<r?t/r:t>1-r?(1-t)/r:1));this.additive&&Vs(1);let a=this.pos,o=this.angle;if(this.localSpaceEmitter&&(a=this.localSpaceEmitter.pos.add(a.rotate(-this.localSpaceEmitter.angle)),o+=this.localSpaceEmitter.angle),this.trailScale){let l=this.velocity;this.localSpaceEmitter&&(l=l.rotate(-this.localSpaceEmitter.angle));const h=l.length(),c=l.scale(1/h),u=h*this.trailScale;i.y=nt(i.x,u),o=c.angle(),De(a.add(c.multiply(d(0,-u/2))),i,this.tileIndex,this.tileSize,n,o,this.mirror)}else De(a,i,this.tileIndex,this.tileSize,n,o,this.mirror);this.additive&&Vs(),Tt&&ae(a,i,"#f005",0,o),t==1&&(this.color=n,this.size=i,this.destroyCallback&&this.destroyCallback(this),this.destroyed=1)}}let Ye=[],we;function qn(){if(!Ye.length)return;const e=Ye[0],t=cs-we;if(!we)we=cs;else if(t>Ws)Ye.shift(we=0);else{const s=Ws-ye,i=t<ye?1-t/ye:t>s?(t-s)/ye:0;e.render(i)}}let ht,w,xi,ve,Si,It,rs,gt,as,_s;function Zn(){ht=document.createElement("canvas"),w=ht.getContext("webgl",{antialias:!1}),xi=Qn(et),document.body.appendChild(ht),ve=Jn("precision highp float;uniform mat4 m;attribute vec2 p,t;attribute vec4 c,a;varying vec4 v,d,e;void main(){gl_Position=m*vec4(p,1,1);v=vec4(t,p);d=c;e=a;}","precision highp float;varying vec4 v,d,e;uniform sampler2D s;void main(){gl_FragColor=texture2D(s,v.xy)*d+e;}");const e=new ArrayBuffer(ki);Si=w.createBuffer(),It=new Float32Array(e),rs=new Uint32Array(e),gt=0}function vi(e){_s=e}function Ks(e,t){const s=w.createShader(t);if(w.shaderSource(s,e),w.compileShader(s),!w.getShaderParameter(s,pr))throw w.getShaderInfoLog(s);return s}function Jn(e,t){const s=w.createProgram();if(w.attachShader(s,Ks(e,gr)),w.attachShader(s,Ks(t,fr)),w.linkProgram(s),!w.getProgramParameter(s,yr))throw w.getProgramInfoLog(s);return s}function Qn(e){const t=w.createTexture();w.bindTexture(xt,t),e&&e.width&&w.texImage2D(xt,0,Js,Js,os,e);const s=rr;return w.texParameteri(xt,or,s),w.texParameteri(xt,ar,s),w.texParameteri(xt,lr,Qs),w.texParameteri(xt,cr,Qs),t}function tr(){w.viewport(0,0,ht.width=x.width,ht.height=x.height),w.clear(hr),w.useProgram(ve),w.activeTexture(ur),w.bindTexture(xt,xi),w.bindBuffer(ls,Si),w.bufferData(ls,ki,dr),vi();let e=0;const t=(r,n,a,o,l=0)=>{const h=w.getAttribLocation(ve,r);w.enableVertexAttribArray(h),w.vertexAttribPointer(h,o,n,l,Ei,e),e+=o*a};t("p",Zs,4,2),t("t",Zs,4,2),t("c",os,1,4,1),t("a",os,1,4,1);const s=2*K/x.width,i=2*K/x.height;w.uniformMatrix4fv(w.getUniformLocation(ve,"m"),0,new Float32Array([s,0,0,0,0,i,0,0,1,1,-1,1,-1-s*V.x,-1-i*V.y,0,0]))}function _i(){if(!gt)return;const e=as?qs:ir;w.blendFuncSeparate(sr,e,qs,e),w.enable(nr),w.bufferSubData(ls,0,It.subarray(0,gt*Pe*Ci)),w.drawArrays(er,0,gt*Pe),gt=0,as=_s}function _e(e,t){!gt&&!t||(_i(),t&&e.drawImage(ht,0,0))}function Ys(e,t,s,i,r,n,a,o,l,h,c=0){(gt==Ti||as!=_s)&&_i();const u=Math.cos(r)/2,f=Math.sin(r)/2,m=u*s,b=u*i,A=f*s,D=f*i;for(let E=6,_=gt++*Pe*Ci;E--;){const I=E-4&&E>1,k=E-5&&E-2&&E-1;It[_++]=e+(I?-m:m)+(k?D:-D),It[_++]=t+(k?b:-b)+(I?A:-A),It[_++]=I?n:o,It[_++]=k?a:l,rs[_++]=h,rs[_++]=c}}const qs=1,er=4,sr=770,ir=771,nr=3042,xt=3553,os=5121,Zs=5126,Js=6408,rr=9728,ar=10240,or=10241,lr=10242,cr=10243,hr=16384,Qs=33071,ur=33984,ls=34962,dr=35048,fr=35632,gr=35633,pr=35713,yr=35714,Pe=6,Ci=6,Ti=65536,Ei=4*2*2+4*2,ki=Ti*Pe*Ei,Cs="LittleJS",mr="1.6.4",Ts=60,Ai=1/Ts;let st=[],Di=[],br=0,q=0,cs=0,wr=0;function xr(e,t,s,i,r,n){et.onerror=et.onload=()=>{Kt=d(Vt).divide(Xt=d(et.width,et.height)),et.onload=()=>B(1);const c="margin:0;overflow:hidden;background:#000;touch-action:none;user-select:none;-webkit-user-select:none";document.body.style=c,document.body.appendChild(x=document.createElement("canvas")),Y=x.getContext("2d"),Cn(),Zn(),document.body.appendChild(lt=document.createElement("canvas")),p=lt.getContext("2d");const u="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)";(ht||x).style=x.style=lt.style=u,e(),h()};let a=0,o,l;function h(c=0){let u=c-a;a=c,l=Gt(.05,l,1e3/(u||1));const f=se(107),m=se(109);if(u*=f?5:m?.2:1,cs+=u/1e3,o+=!wr*u,f||(o=it(o,50)),Se.x){x.width=Se.x,x.height=Se.y;const b=innerWidth/innerHeight,A=x.width/x.height;(ht||x).style.width=x.style.width=lt.style.width=b<A?"100%":"",(ht||x).style.height=x.style.height=lt.style.height=b<A?"":"100%"}else x.width=it(innerWidth,Fs.x),x.height=it(innerHeight,Fs.y);lt.width=x.width,lt.height=x.height,pt=d(x.width,x.height);{let b=0;for(o<0&&o>-9&&(b=o,o=0);o>=0;o-=1e3/Ts)Hn(),t(),vr(),Tn(),s(),Wn();o+=b}Sr(),i(),st.sort((b,A)=>b.renderOrder-A.renderOrder);for(const b of st)b.destroyed||b.render();if(r(),qn(),En(),_e(Y),ee){p.textAlign="right",p.textBaseline="top",p.font="1em monospace",p.fillStyle="#000";const b=Cs+" v"+mr+" / "+is+" / "+st.length+" / "+l.toFixed(1)+" GL";p.fillText(b,x.width-3,3),p.fillStyle="#fff",p.fillText(b,x.width-2,2),is=0}requestAnimationFrame(h)}n?et.src=n:et.onload()}function Sr(){pt=d(x.width,x.height),Y.imageSmoothingEnabled=!ui,tr()}function vr(){Di=st.filter(t=>t.collideSolidObjects);const e=t=>{if(!t.destroyed){t.update();for(const s of t.children)e(s)}};for(const t of st)t.parent||e(t);st=st.filter(t=>!t.destroyed),q=++br/Ts}const _r=e=>V=e,Cr=e=>Se=e,Pi=e=>Jt=e,Tr=e=>ee=e,Er=e=>ci=e;class Es extends Pt{constructor(t){super(d(0,1.25),d(4,.5)),this.levelSize=t,this.color=new y(1,1,1,.5),this.setCollision(!0),this.mass=0}update(){const t=this.size.x*.5,s=this.levelSize.x-t;this.pos.x=R(ft.x,t,s)}increaseSize(){this.size.x+=2}decreaseSize(){this.size.x-=2,this.size.x<2&&(this.size.x=2)}resetSize(){this.size.x=4}}class Ce extends Pt{constructor(t,s){super(t,s),this.setCollision(!0),this.mass=0,this.color=new y().setHex("#494746")}}const j=d(38,20),kr=(e,t)=>e===t,Me=Symbol("solid-proxy"),Ar=Symbol("solid-track"),$e={equals:kr};let Mi=Ii;const yt=1,Oe=2,$i={owned:null,cleanups:null,context:null,owner:null};var z=null;let qe=null,O=null,F=null,ut=null,Ue=0;function Te(e,t){const s=O,i=z,r=e.length===0,n=t===void 0?i:t,a=r?$i:{owned:null,cleanups:null,context:n?n.context:null,owner:n},o=r?e:()=>e(()=>At(()=>Fe(a)));z=a,O=null;try{return le(o,!0)}finally{O=s,z=i}}function W(e,t){t=t?Object.assign({},$e,t):$e;const s={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},i=r=>(typeof r=="function"&&(r=r(s.value)),Bi(s,r));return[Oi.bind(s),i]}function H(e,t,s){const i=ks(e,t,!1,yt);oe(i)}function Dr(e,t,s){Mi=Or;const i=ks(e,t,!1,yt);(!s||!s.render)&&(i.user=!0),ut?ut.push(i):oe(i)}function ie(e,t,s){s=s?Object.assign({},$e,s):$e;const i=ks(e,t,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=s.equals||void 0,oe(i),Oi.bind(i)}function At(e){if(O===null)return e();const t=O;O=null;try{return e()}finally{O=t}}function Pr(e){return z===null||(z.cleanups===null?z.cleanups=[e]:z.cleanups.push(e)),e}function Oi(){if(this.sources&&this.state)if(this.state===yt)oe(this);else{const e=F;F=null,le(()=>Ie(this),!1),F=e}if(O){const e=this.observers?this.observers.length:0;O.sources?(O.sources.push(this),O.sourceSlots.push(e)):(O.sources=[this],O.sourceSlots=[e]),this.observers?(this.observers.push(O),this.observerSlots.push(O.sources.length-1)):(this.observers=[O],this.observerSlots=[O.sources.length-1])}return this.value}function Bi(e,t,s){let i=e.value;return(!e.comparator||!e.comparator(i,t))&&(e.value=t,e.observers&&e.observers.length&&le(()=>{for(let r=0;r<e.observers.length;r+=1){const n=e.observers[r],a=qe&&qe.running;a&&qe.disposed.has(n),(a?!n.tState:!n.state)&&(n.pure?F.push(n):ut.push(n),n.observers&&zi(n)),a||(n.state=yt)}if(F.length>1e6)throw F=[],new Error},!1)),t}function oe(e){if(!e.fn)return;Fe(e);const t=z,s=O,i=Ue;O=z=e,Mr(e,e.value,i),O=s,z=t}function Mr(e,t,s){let i;try{i=e.fn(t)}catch(r){return e.pure&&(e.state=yt,e.owned&&e.owned.forEach(Fe),e.owned=null),e.updatedAt=s+1,Li(r)}(!e.updatedAt||e.updatedAt<=s)&&(e.updatedAt!=null&&"observers"in e?Bi(e,i):e.value=i,e.updatedAt=s)}function ks(e,t,s,i=yt,r){const n={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:z,context:z?z.context:null,pure:s};return z===null||z!==$i&&(z.owned?z.owned.push(n):z.owned=[n]),n}function Be(e){if(e.state===0)return;if(e.state===Oe)return Ie(e);if(e.suspense&&At(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ue);)e.state&&t.push(e);for(let s=t.length-1;s>=0;s--)if(e=t[s],e.state===yt)oe(e);else if(e.state===Oe){const i=F;F=null,le(()=>Ie(e,t[0]),!1),F=i}}function le(e,t){if(F)return e();let s=!1;t||(F=[]),ut?s=!0:ut=[],Ue++;try{const i=e();return $r(s),i}catch(i){s||(ut=null),F=null,Li(i)}}function $r(e){if(F&&(Ii(F),F=null),e)return;const t=ut;ut=null,t.length&&le(()=>Mi(t),!1)}function Ii(e){for(let t=0;t<e.length;t++)Be(e[t])}function Or(e){let t,s=0;for(t=0;t<e.length;t++){const i=e[t];i.user?e[s++]=i:Be(i)}for(t=0;t<s;t++)Be(e[t])}function Ie(e,t){e.state=0;for(let s=0;s<e.sources.length;s+=1){const i=e.sources[s];if(i.sources){const r=i.state;r===yt?i!==t&&(!i.updatedAt||i.updatedAt<Ue)&&Be(i):r===Oe&&Ie(i,t)}}}function zi(e){for(let t=0;t<e.observers.length;t+=1){const s=e.observers[t];s.state||(s.state=Oe,s.pure?F.push(s):ut.push(s),s.observers&&zi(s))}}function Fe(e){let t;if(e.sources)for(;e.sources.length;){const s=e.sources.pop(),i=e.sourceSlots.pop(),r=s.observers;if(r&&r.length){const n=r.pop(),a=s.observerSlots.pop();i<r.length&&(n.sourceSlots[a]=i,r[i]=n,s.observerSlots[i]=a)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Fe(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Br(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Li(e,t=z){throw Br(e)}const Ir=Symbol("fallback");function ti(e){for(let t=0;t<e.length;t++)e[t]()}function zr(e,t,s={}){let i=[],r=[],n=[],a=0,o=t.length>1?[]:null;return Pr(()=>ti(n)),()=>{let l=e()||[],h,c;return l[Ar],At(()=>{let f=l.length,m,b,A,D,E,_,I,k,Q;if(f===0)a!==0&&(ti(n),n=[],i=[],r=[],a=0,o&&(o=[])),s.fallback&&(i=[Ir],r[0]=Te(bt=>(n[0]=bt,s.fallback())),a=1);else if(a===0){for(r=new Array(f),c=0;c<f;c++)i[c]=l[c],r[c]=Te(u);a=f}else{for(A=new Array(f),D=new Array(f),o&&(E=new Array(f)),_=0,I=Math.min(a,f);_<I&&i[_]===l[_];_++);for(I=a-1,k=f-1;I>=_&&k>=_&&i[I]===l[k];I--,k--)A[k]=r[I],D[k]=n[I],o&&(E[k]=o[I]);for(m=new Map,b=new Array(k+1),c=k;c>=_;c--)Q=l[c],h=m.get(Q),b[c]=h===void 0?-1:h,m.set(Q,c);for(h=_;h<=I;h++)Q=i[h],c=m.get(Q),c!==void 0&&c!==-1?(A[c]=r[h],D[c]=n[h],o&&(E[c]=o[h]),c=b[c],m.set(Q,c)):n[h]();for(c=_;c<f;c++)c in A?(r[c]=A[c],n[c]=D[c],o&&(o[c]=E[c],o[c](c))):r[c]=Te(u);r=r.slice(0,a=f),i=l.slice(0)}return r});function u(f){if(n[c]=f,o){const[m,b]=W(c);return o[c]=b,t(l[c],m)}return t(l[c])}}}function P(e,t){return At(()=>e(t||{}))}function xe(){return!0}const hs={get(e,t,s){return t===Me?s:e.get(t)},has(e,t){return t===Me?!0:e.has(t)},set:xe,deleteProperty:xe,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:xe,deleteProperty:xe}},ownKeys(e){return e.keys()}};function Ze(e){return(e=typeof e=="function"?e():e)?e:{}}function Lr(){for(let e=0,t=this.length;e<t;++e){const s=this[e]();if(s!==void 0)return s}}function ei(...e){let t=!1;for(let n=0;n<e.length;n++){const a=e[n];t=t||!!a&&Me in a,e[n]=typeof a=="function"?(t=!0,ie(a)):a}if(t)return new Proxy({get(n){for(let a=e.length-1;a>=0;a--){const o=Ze(e[a])[n];if(o!==void 0)return o}},has(n){for(let a=e.length-1;a>=0;a--)if(n in Ze(e[a]))return!0;return!1},keys(){const n=[];for(let a=0;a<e.length;a++)n.push(...Object.keys(Ze(e[a])));return[...new Set(n)]}},hs);const s={},i={},r=new Set;for(let n=e.length-1;n>=0;n--){const a=e[n];if(!a)continue;const o=Object.getOwnPropertyNames(a);for(let l=0,h=o.length;l<h;l++){const c=o[l];if(c==="__proto__"||c==="constructor")continue;const u=Object.getOwnPropertyDescriptor(a,c);if(!r.has(c))u.get?(r.add(c),Object.defineProperty(s,c,{enumerable:!0,configurable:!0,get:Lr.bind(i[c]=[u.get.bind(a)])})):(u.value!==void 0&&r.add(c),s[c]=u.value);else{const f=i[c];f?u.get?f.push(u.get.bind(a)):u.value!==void 0&&f.push(()=>u.value):s[c]===void 0&&(s[c]=u.value)}}}return s}function Rr(e,...t){if(Me in e){const r=new Set(t.length>1?t.flat():t[0]),n=t.map(a=>new Proxy({get(o){return a.includes(o)?e[o]:void 0},has(o){return a.includes(o)&&o in e},keys(){return a.filter(o=>o in e)}},hs));return n.push(new Proxy({get(a){return r.has(a)?void 0:e[a]},has(a){return r.has(a)?!1:a in e},keys(){return Object.keys(e).filter(a=>!r.has(a))}},hs)),n}const s={},i=t.map(()=>({}));for(const r of Object.getOwnPropertyNames(e)){const n=Object.getOwnPropertyDescriptor(e,r),a=!n.get&&!n.set&&n.enumerable&&n.writable&&n.configurable;let o=!1,l=0;for(const h of t)h.includes(r)&&(o=!0,a?i[l][r]=n.value:Object.defineProperty(i[l],r,n)),++l;o||(a?s[r]=n.value:Object.defineProperty(s,r,n))}return[...i,s]}const Nr=e=>`Stale read from <${e}>.`;function Ri(e){const t="fallback"in e&&{fallback:()=>e.fallback};return ie(zr(()=>e.each,e.children,t||void 0))}function As(e){const t=e.keyed,s=ie(()=>e.when,void 0,{equals:(i,r)=>t?i===r:!i==!r});return ie(()=>{const i=s();if(i){const r=e.children;return typeof r=="function"&&r.length>0?At(()=>r(t?i:()=>{if(!At(s))throw Nr("Show");return e.when})):r}return e.fallback},void 0,void 0)}const[Ut,zt]=W(L.Modern),[He,Ni]=W(0),[ne,ji]=W(!0),[te,Ui]=W(!0),[Fi,St]=W(0),[Hi,us]=W(0),[re,ds]=W(!1),[Ds,Wi]=W(0),[Gi,fs]=W(!1),[Vi,gs]=W(!1),[Xi,ps]=W(!1),[Ps,Ms]=W(0),jr=Object.freeze(Object.defineProperty({__proto__:null,adRewardDisabled:re,adRewardTimeLeft:Ds,bonusLevelCounter:Ps,extraLifeDialogShown:Xi,gameOverDialogShown:Gi,gameWinDialogShown:Vi,highScore:Hi,mode:Ut,music:te,score:Fi,setAdRewardDisabled:ds,setAdRewardTimeLeft:Wi,setBonusLevelCounter:Ms,setExtraLifeDialogShown:ps,setGameOverDialogShown:fs,setGameWinDialogShown:gs,setHighScore:us,setMode:zt,setMusic:Ui,setScore:St,setSound:ji,setStage:Ni,sound:ne,stage:He},Symbol.toStringTag,{value:"Module"}));class Ur{constructor(t,s){g(this,"prefix","Breakout-");this.key=t,this.defaultValue=s,this.set(this.get())}get(){const t=localStorage.getItem(this.prefix+this.key);return t||this.defaultValue}toString(){return Number(this.get())}toValue(){return Number(this.get())}set(t){localStorage.setItem(this.prefix+this.key,String(t))}reset(){this.set(this.defaultValue)}}class We{constructor(t,s=0,i=9){g(this,"value");this.initialValue=t,this.MIN=s,this.MAX=i,this.value=this.apply(t)}decrement(){this.value=this.apply(--this.value)}increment(){this.value=this.apply(++this.value)}restore(){this.value=this.initialValue}add(t){this.value+=t,this.value=this.apply(this.value)}sub(t){this.value-=t,this.value=this.apply(this.value)}getValue(){return this.value}hasValue(){return this.value>0}setMax(){this.value=this.MAX}setMin(){this.value=this.MIN}setVal(t){this.value=this.apply(t)}apply(t){return Math.min(Math.max(t,this.MIN),this.MAX)}}class Fr{constructor(t){g(this,"score");g(this,"highScore");this.initialValue=t,this.score=new We(t,0,1e16),this.highScore=new Ur("highScore",0),us(this.highScore.toValue()),St(this.score.getValue())}increment(){this.score.increment(),St(this.score.getValue()),this.evaluateHighScore()}decrement(){this.score.decrement(),St(this.score.getValue),this.evaluateHighScore()}add(t){this.score.add(t),St(this.score.getValue()),this.evaluateHighScore()}double(){this.score.setVal(this.score.getValue()*2),St(this.score.getValue()),this.evaluateHighScore()}reset(){this.score.restore(),St(this.initialValue)}toString(){return this.score.toString()}toValue(){return this.score.getValue()}getHighScore(){return this.highScore}evaluateHighScore(){this.score.getValue()>this.highScore.toValue()&&(this.highScore.set(this.score.getValue()),us(this.score.getValue()))}}const Hr=""+new URL("tiles-75ceaa43.png",import.meta.url).href,Ki={enabled(){return window.location.hash.includes("debug")},disabled(){return!this.enabled()}};var T=(e=>(e[e.ExtraScore=0]="ExtraScore",e[e.ExtraBalls=1]="ExtraBalls",e[e.PaddleIncrease=2]="PaddleIncrease",e[e.ExtraLife=3]="ExtraLife",e[e.ExtraWall=4]="ExtraWall",e[e.PaddleDecrease=5]="PaddleDecrease",e[e.DoubleBalls=6]="DoubleBalls",e[e.TripleBalls=7]="TripleBalls",e[e.ExtraStrength=8]="ExtraStrength",e))(T||{});class mt{constructor(t){g(this,"timers",[]);g(this,"timeout",1e4);this.game=t}clearTimers(){this.timers.forEach(clearTimeout)}}let si=class extends mt{constructor(t){super(t)}apply(){if(this.game.balls.hasValue()){const t=this.game.balls.getOne();if(!t||t.destroyed)return;this.game.balls.spawnManyAt(V,3)}}};class Wr extends mt{constructor(t){super(t)}apply(){this.game.lives.increment()}}class Gr extends mt{constructor(t){super(t)}apply(){var t;(t=this.game.paddle)==null||t.increaseSize(),this.timers.push(setTimeout(()=>{var s;(s=this.game.paddle)==null||s.decreaseSize()},this.timeout))}}class Vr extends mt{constructor(t){super(t)}apply(){var t;(t=this.game.paddle)==null||t.decreaseSize(),this.timers.push(setTimeout(()=>{var s;(s=this.game.paddle)==null||s.increaseSize()},this.timeout))}}class Xr extends mt{constructor(t){super(t)}apply(){this.game.score.add(10)}}class Kr extends mt{constructor(s){super(s);g(this,"size",d(j.x,.25));g(this,"position",d(j.x*.5,.14))}apply(){var s;(s=this.game.floor)==null||s.destroy(),this.game.floor=new Ce(this.position,this.size),this.game.floor.color=new y(1,1,1,.5),this.timers.push(setTimeout(()=>{var i;(i=this.game.floor)==null||i.destroy(),this.game.floor=null},this.timeout))}}class Yr extends mt{constructor(t){super(t)}apply(){this.game.balls.hasValue()&&this.game.balls.double()}}class qr extends mt{constructor(t){super(t)}apply(){this.game.balls.hasValue()&&this.game.balls.triple()}}const Yi=[[6,1],[5,10],[16,11],[12,7],[15,20],[17,0],[26,21],[2,27],[31,30]],Zr=22,Jr=new y().setHex("#486370"),ze=[new y().setHex("#00854A"),new y().setHex("#8CC63F"),new y().setHex("#FFDD00"),new y().setHex("#ED1B25"),new y().setHex("#91278F"),new y().setHex("#005AAB"),new y().setHex("#00AAE5"),new y().setHex("#F7931F"),new y().setHex("#744C1F")];if(ze.length!==Yi.length)throw new Error("Colors and Tiles must have the same length");var qi={exports:{}};function $s(){}$s.prototype={on:function(e,t,s){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:s}),this},once:function(e,t,s){var i=this;function r(){i.off(e,r),t.apply(s,arguments)}return r._=t,this.on(e,r,s)},emit:function(e){var t=[].slice.call(arguments,1),s=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=s.length;for(i;i<r;i++)s[i].fn.apply(s[i].ctx,t);return this},off:function(e,t){var s=this.e||(this.e={}),i=s[e],r=[];if(i&&t)for(var n=0,a=i.length;n<a;n++)i[n].fn!==t&&i[n].fn._!==t&&r.push(i[n]);return r.length?s[e]=r:delete s[e],this}};qi.exports=$s;var Qr=qi.exports.TinyEmitter=$s;const v=new Qr;class t0 extends Pt{constructor(s,i){super(s,d(.5));g(this,"type");g(this,"sign",1);g(this,"stopped",!1);g(this,"oldVelocity",d(0));this.type=i,this.setCollision(!0),this.velocity=d(0,-.1),this.color=ze[this.type],this.sign=Ht(0,1)===0?-1:1}getType(){return this.type}update(){this.stopped||(this.angle+=this.sign*.3,this.pos.y<0&&this.destroy(),super.update())}collideWithObject(s){return s instanceof Es&&(v.emit("bonusCollected",this),this.destroy()),!1}stopMovement(){this.stopped=!0,this.oldVelocity=this.velocity,this.velocity=d(0)}resumeMovement(){this.stopped=!1,this.velocity=this.oldVelocity}}class e0{constructor(t,s=null){this.value=t,this.next=s}}class ce{constructor(){g(this,"head");g(this,"tail");g(this,"length");this.head=null,this.tail=null,this.length=0}add(t){const s=new e0(t);if(this.head===null){this.head=s,this.tail=s,this.length++;return}this.tail===null&&(this.tail=s),this.tail.next=s,this.tail=s,this.length++}remove(t){if(this.head===null)return;if(this.head.value===t){this.head=this.head.next,this.head===null&&(this.tail=null),this.length--;return}let s=this.head;for(;s.next!==null;){if(s.next.value===t){s.next=s.next.next,s.next===null&&(this.tail=s),this.length--;return}s=s.next}}has(t){if(this.head===null)return!1;let s=this.head;for(;s!==null;){if(s.value===t)return!0;s=s.next}return!1}*[Symbol.iterator](){if(this.head===null)return;let t=this.head;for(;t!==null;)yield t.value,t=t.next}toArray(){const t=[];let s=this.head;for(;s!==null;)t.push(s.value),s=s.next;return t}getLength(){return this.length}isEmpty(){return this.length===0}peek(){var t;return(t=this.head)==null?void 0:t.value}clear(){this.head=null,this.tail=null,this.length=0}}class s0{constructor(t){g(this,"commands");g(this,"bonuses",new ce);this.commands={[T.ExtraBalls]:new si(t),[T.ExtraLife]:new Wr(t),[T.PaddleIncrease]:new Gr(t),[T.PaddleDecrease]:new Vr(t),[T.ExtraScore]:new Xr(t),[T.ExtraWall]:new Kr(t),[T.DoubleBalls]:new Yr(t),[T.TripleBalls]:new qr(t),[T.ExtraStrength]:new si(t)}}collect(t){this.commands[t.getType()].apply();for(const s of this.bonuses)s.destroyed&&this.bonuses.remove(s)}produce(t){this.bonuses.add(new t0(d(Ht(2,j.x-2),j.y-2),t))}clearTimers(){for(const t of Object.values(this.commands))t.clearTimers()}destroy(){this.clearTimers();for(const t of this.bonuses)t.destroy(),this.bonuses.remove(t)}stop(){for(const t of this.bonuses)t.stopMovement()}resume(){for(const t of this.bonuses)t.resumeMovement()}}var Et=(e=>(e[e.Empty=0]="Empty",e[e.Normal=1]="Normal",e[e.Hard=2]="Hard",e[e.Unbreakable=3]="Unbreakable",e))(Et||{});class ${constructor(t,s){g(this,"offsetX",0);g(this,"offsetY",10);g(this,"blockWidth",2);g(this,"blockHeight",1);g(this,"count");g(this,"coords");g(this,"key");this.name=t,this.map=s,this.map=s.reverse(),this.count=this.countBricks(),this.coords=this.calcCoords(),this.key=`Stage:${this.name}`}getMap(){return this.map}getBrickCount(){return this.count}brickCountEquals(t){return this.count===t.getValue()}getCoords(){return this.coords}countBricks(){return this.map.reduce((t,s)=>t+s.reduce((i,r)=>i+(r===1?1:0),0),0)}calcCoords(){const t=[];for(const[s,i]of this.map.entries())for(const[r,n]of i.entries())n!==Et.Empty&&t.push([n,d(r*this.blockWidth+this.offsetX,s*this.blockHeight+this.offsetY)]);return t}isUnlocked(){return localStorage.getItem(this.key)==="unlocked"}unlock(){localStorage.setItem(this.key,"unlocked"),v.emit("stage-unlocked",this.name)}}const Zi=[new class extends ${constructor(){super("01",[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,0],[0,1,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("02",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,3,0,1,0,3,1,0,3,1,0,3,0,1,0,3,0,1,1],[1,0,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,0,0,1],[1,0,3,0,1,0,3,1,0,3,1,0,3,0,1,0,3,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("03",[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0],[0,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0],[0,0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,0],[0,0,1,1,1,1,0,0,1,1,0,1,1,1,0,0,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("04",[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("05",[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("06",[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3],[3,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,3],[3,1,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,1,3],[3,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("07",[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3],[3,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,3],[3,1,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,1,3],[3,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,3],[3,3,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,3,3],[0,3,3,3,0,0,0,0,1,0,1,0,0,0,0,0,3,3,3,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("08",[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3],[3,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,3],[3,1,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,1,3],[3,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,3],[3,3,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,3,3,3],[3,3,3,3,3,3,0,0,1,0,1,0,0,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("09",[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3],[3,1,3,1,3,1,0,0,0,0,0,0,0,0,1,3,1,3,1,3],[3,1,3,3,3,1,1,1,0,0,0,0,1,1,1,3,3,3,1,3],[3,3,3,3,3,0,0,1,1,1,1,1,1,0,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("10",[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3],[3,1,0,1,0,1,0,0,1,1,1,1,0,0,1,0,1,0,1,3],[3,1,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,1,3],[3,0,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,0,3],[3,3,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,3,3,3],[3,3,3,3,3,3,3,3,1,0,1,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("11",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("12",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("13",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("14",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("15",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("16",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("17",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("18",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("19",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}},new class extends ${constructor(){super("20",[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),this.unlock()}}];class i0{constructor(t){g(this,"game");g(this,"stages");g(this,"index",0);g(this,"currentStage");this.game=t,this.stages=Zi,this.currentStage=this.stages[this.index]}get current(){return this.currentStage}showClickToStartText(){new Ke().drawText("Click to Start",V.add(d(0,-5)),.1,!0)}showCurrentStageText(){const t=this.game.mode.isBonus()?"Bonus Stage":`Stage ${this.currentStage.name}`;new Ke().drawText(t,V.add(d(0,0)),.2,!0)}showCounterText(){const t=[];t.push(`Score: ${String(this.game.score.toValue()).padStart(4,"0")}`),t.push(`Lives: ${String(this.game.lives.getValue()).padStart(2,"0")}`),this.game.mode.isBonus()||t.push(`Stage: ${String(this.game.stage.currentStage.name).padStart(2,"0")}`),t.push(`Mode: ${this.game.mode.toString()}`),t.push(`High-Score: ${String(this.game.score.getHighScore()).padStart(6,"0")}`),this.game.mode.isBonus()&&t.push(`Ends: ${String(Ps()).padStart(2,"0")}`),new Ke().drawText(t.join(" | "),d(j.x*.5,j.y+.5),.07,!0)}execute(t){this.index=t,this.currentStage=this.stages[this.index]}next(){this.index=Math.min(this.index+1,this.stages.length-1),this.currentStage=this.stages[this.index],this.game.mode.toggleBonus(),this.start()}start(){this.game.bricks.destroy(),this.game.bricks.populate()}restart(){this.game.bricks.destroy(),this.game.bricks.populate()}isCleared(){return this.currentStage.brickCountEquals(this.game.bricks.destroyed)}}class n0 extends We{runOut(){return!this.hasValue()}}class Os{constructor(t){g(this,"probabilities",[]);t&&this.setProbabilities(t)}setProbabilities(t){this.probabilities=t,this.assertProbabilitiesSumUpToOne()}pick(){this.assertProbabilitiesSumUpToOne();const t=Math.random();let s=0;for(const[i,r]of this.probabilities)if(s+=r/100,t<=s)return i;throw new Error("Failed to pick a number based on probabilities.")}*[Symbol.iterator](){for(const[t]of this.probabilities)yield t}assertProbabilitiesSumUpToOne(){if(this.probabilities.length===0)throw new Error("Probabilities should not be empty.");const t=this.probabilities.reduce((s,[,i])=>s+i,0);if(t!==100)throw new Error(`Probabilities should sum up to 100. Sum is ${t}.`)}}class Bs extends Pt{constructor(s,i=d(2,1)){super(s,i);g(this,"strength",1);g(this,"hitCount",0);g(this,"tiles");g(this,"index",0);g(this,"picker");this.picker=new Os([[Et.Normal,70],[Et.Hard,30]]),this.mass=0,this.angle=0,this.setCollision(!0),this.strength=this.picker.pick(),this.index=Ht(0,ze.length),this.tiles=this.getTileByIndex(this.index),this.color=this.getColorByIndex(this.index),this.tileIndex=this.tiles[this.hitCount],this.tileSize=d(384,128),this.renderOrder=-1}get score(){return this.strength}getStrength(){return this.strength}setStrength(s){this.strength=s}increaseHitCount(){this.tileIndex=this.tiles[++this.hitCount],this.angle=M(-.3,.3)}shallBeDestroyed(){return this.hitCount>=this.strength}getColorByIndex(s){return ze[s]}getTileByIndex(s){return Yi[s]}}v.on("sound",()=>{Pi(ne()),console.info("Sound is",ne()?"enabled":"disabled")});v.emit("music",()=>{console.info("Music is",te()?"enabled":"disabled")});const Ee={GameStart:new me([,0,500,,.04,.3,1,2,,,570,.02,.02,,,,.04]),BallBounce:new me([,,119,.02,.01,.02,,.26,,.5,,,,,-381,,,,.01,.8]),BrickHit:new me([,,141,,,.02,1,0,,,,,,.5,70,,,,.01]),BrickDestroy:new me([1.37,,574,.04,.27,.3,2,2.9,.6,-.1,,,.13,1.8,,.3,,.25,.01])},ii={BallDestroy:(e,t)=>new Xs(e,0,0,.1,500,3.14,-1,d(8,8),t,t,t.scale(1,0),t.scale(1,0),.2,.1,.45,.1,.05,.98,1,0,3.14,.1,1,!1,!1,!0),BrickHit:(e,t)=>new Xs(e,0,0,.1,50,.45,4,d(10,10),t,t,t.scale(1,0),t.scale(1,0),.2,.1,.45,.39,.05,.98,1,0,1,.1,.99,!0,!0,!1)};class Is extends We{constructor(t){super(t)}static getColor(t){return t===0?new y().setHex("#ffffff"):t===1?new y().setHex("#ffffff"):t===2?new y().setHex("#ffd0d0"):t===3?new y().setHex("#ffb0b0"):t===4?new y().setHex("#ff9090"):t===5?new y().setHex("#ff7070"):t===6?new y().setHex("#ff5050"):t===7?new y().setHex("#ff3030"):t===8?new y().setHex("#ff1010"):new y().setHex("#ff0000")}getColor(){return Is.getColor(this.value)}}class r0 extends Pt{constructor(s,i=1){super(s,d(.25));g(this,"strength");g(this,"stopped",!1);g(this,"oldVelocity",d(0));this.strength=new Is(i);const r=Ht(0,2)===0?-1:1;this.velocity=d(.1*r,-.1),this.setCollision(!0),this.elasticity=1}collideWithObject(s){const i=s instanceof Bs,r=s instanceof Es;return i?this.handleBrickCollision(s):r?this.handlePaddleCollision(s):!0}update(){if(!this.stopped)return this.angleVelocity=this.velocity.length()*10,this.color=this.strength.getColor(),super.update()}stopMovement(){this.stopped=!0,this.oldVelocity=this.velocity,this.velocity=d(0)}resumeMovement(){this.stopped=!1,this.velocity=this.oldVelocity}handleBrickCollision(s){this.strength.sub(s.getStrength());const{color:i}=s;return Ee.BrickHit.play(this.pos),s.increaseHitCount(),s.shallBeDestroyed()?(ii.BallDestroy(this.pos,i),Ee.BrickDestroy.play(this.pos),v.emit("brickDestroyed",s),s.destroy()):ii.BrickHit(this.pos,i),!this.strength.hasValue()}handlePaddleCollision(s){this.strength.restore();const i=this.velocity.length()+.5;Ee.BallBounce.play(this.pos,1,i);const r=this.pos.x-s.pos.x;this.velocity=this.velocity.rotate(r*.3),this.velocity.y=nt(this.velocity.y,.3);const n=it(1.04*this.velocity.length(),.5);return this.velocity=this.velocity.normalize().scale(n),!1}}class a0{constructor(){g(this,"MAX_BALLS",200);g(this,"balls");g(this,"picker");g(this,"strength",1);this.balls=new ce,this.picker=new Os([[-.5,50],[.5,50]])}add(t){this.balls.add(t)}setStrength(t){this.strength=t}remove(t){this.balls.remove(t)}spawnOneAt(t=V){if(this.balls.getLength()<this.MAX_BALLS){const s=this.picker.pick(),i=this.picker.pick();this.add(new r0(d(t.x+s,t.y+i),this.strength))}}spawnManyAt(t=V,s=1){for(let i=0;i<s;i++)this.spawnOneAt(t)}double(){for(const t of this.balls.toArray())this.spawnOneAt(t.pos)}triple(){for(const t of this.balls.toArray())this.spawnManyAt(t.pos,2)}hasValue(){return!this.balls.isEmpty()}escaped(){return this.balls.isEmpty()}getOne(){return this.balls.peek()}update(){for(const t of this.balls)t.pos.y<-1&&t.destroy(),t.destroyed&&this.balls.remove(t)}*[Symbol.iterator](){for(const t of this.balls)yield t}destroy(){for(const t of this.balls)t.destroy();this.balls.clear()}stop(){for(const t of this.balls)t.stopMovement()}resume(){for(const t of this.balls)t.resumeMovement()}}let he=class{constructor(t){g(this,"bonusPicker",new Os);g(this,"timers",[]);this.game=t}async update(){}pickBonus(){return this.bonusPicker.pick()}clearTimers(){this.timers.forEach(clearTimeout)}};var kt=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var t=1.70158;return e===1?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-kt.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?kt.Bounce.In(e*2)*.5:kt.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(t*2,e)/2:(1-Math.pow(2-t*2,e))/2+.5}}}}),Yt=function(){return performance.now()},o0=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(s){return t._tweens[s]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},e.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},e.prototype.update=function(t,s){t===void 0&&(t=Yt()),s===void 0&&(s=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var n=this._tweens[i[r]],a=!s;n&&n.update(t,a)===!1&&!s&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),Lt={Linear:function(e,t){var s=e.length-1,i=s*t,r=Math.floor(i),n=Lt.Utils.Linear;return t<0?n(e[0],e[1],i):t>1?n(e[s],e[s-1],s-i):n(e[r],e[r+1>s?s:r+1],i-r)},Bezier:function(e,t){for(var s=0,i=e.length-1,r=Math.pow,n=Lt.Utils.Bernstein,a=0;a<=i;a++)s+=r(1-t,i-a)*r(t,a)*e[a]*n(i,a);return s},CatmullRom:function(e,t){var s=e.length-1,i=s*t,r=Math.floor(i),n=Lt.Utils.CatmullRom;return e[0]===e[s]?(t<0&&(r=Math.floor(i=s*(1+t))),n(e[(r-1+s)%s],e[r],e[(r+1)%s],e[(r+2)%s],i-r)):t<0?e[0]-(n(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[s]-(n(e[s],e[s],e[s-1],e[s-1],i-s)-e[s]):n(e[r?r-1:0],e[r],e[s<r+1?s:r+1],e[s<r+2?s:r+2],i-r)},Utils:{Linear:function(e,t,s){return(t-e)*s+e},Bernstein:function(e,t){var s=Lt.Utils.Factorial;return s(e)/s(t)/s(e-t)},Factorial:function(){var e=[1];return function(t){var s=1;if(e[t])return e[t];for(var i=t;i>1;i--)s*=i;return e[t]=s,s}}(),CatmullRom:function(e,t,s,i,r){var n=(s-e)*.5,a=(i-t)*.5,o=r*r,l=r*o;return(2*t-2*s+n+a)*l+(-3*t+3*s-2*n-a)*o+n*r+t}}},l0=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),ys=new o0,Ji=function(){function e(t,s){s===void 0&&(s=ys),this._object=t,this._group=s,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=kt.Linear.None,this._interpolationFunction=Lt.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=l0.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(t,s){if(s===void 0&&(s=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=s,this},e.prototype.duration=function(t){return t===void 0&&(t=1e3),this._duration=t,this},e.prototype.dynamic=function(t){return t===void 0&&(t=!1),this._isDynamic=t,this},e.prototype.start=function(t,s){if(t===void 0&&(t=Yt()),s===void 0&&(s=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||s){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var n in this._valuesEnd)r[n]=this._valuesEnd[n];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,s)}return this},e.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},e.prototype._setupProperties=function(t,s,i,r,n){for(var a in i){var o=t[a],l=Array.isArray(o),h=l?"array":typeof o,c=!l&&Array.isArray(i[a]);if(!(h==="undefined"||h==="function")){if(c){var u=i[a];if(u.length===0)continue;for(var f=[o],m=0,b=u.length;m<b;m+=1){var A=this._handleRelativeValue(o,u[m]);if(isNaN(A)){c=!1,console.warn("Found invalid interpolation list. Skipping.");break}f.push(A)}c&&(i[a]=f)}if((h==="object"||l)&&o&&!c){s[a]=l?[]:{};var D=o;for(var E in D)s[a][E]=D[E];r[a]=l?[]:{};var u=i[a];if(!this._isDynamic){var _={};for(var E in u)_[E]=u[E];i[a]=u=_}this._setupProperties(D,s[a],u,r[a],n)}else(typeof s[a]>"u"||n)&&(s[a]=o),l||(s[a]*=1),c?r[a]=i[a].slice().reverse():r[a]=s[a]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(t){return t===void 0&&(t=Yt()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this),this)},e.prototype.resume=function(t){return t===void 0&&(t=Yt()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},e.prototype.stopChainedTweens=function(){for(var t=0,s=this._chainedTweens.length;t<s;t++)this._chainedTweens[t].stop();return this},e.prototype.group=function(t){return t===void 0&&(t=ys),this._group=t,this},e.prototype.delay=function(t){return t===void 0&&(t=0),this._delayTime=t,this},e.prototype.repeat=function(t){return t===void 0&&(t=0),this._initialRepeat=t,this._repeat=t,this},e.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},e.prototype.yoyo=function(t){return t===void 0&&(t=!1),this._yoyo=t,this},e.prototype.easing=function(t){return t===void 0&&(t=kt.Linear.None),this._easingFunction=t,this},e.prototype.interpolation=function(t){return t===void 0&&(t=Lt.Linear),this._interpolationFunction=t,this},e.prototype.chain=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return this._chainedTweens=t,this},e.prototype.onStart=function(t){return this._onStartCallback=t,this},e.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},e.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},e.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},e.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},e.prototype.onStop=function(t){return this._onStopCallback=t,this},e.prototype.update=function(t,s){if(t===void 0&&(t=Yt()),s===void 0&&(s=!0),this._isPaused)return!0;var i,r,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>n)return!1;s&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=this._duration===0||r>1?1:r;var a=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),r===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(i in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[i]=="string"&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,l=this._chainedTweens.length;o<l;o++)this._chainedTweens[o].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(t,s,i,r){for(var n in i)if(s[n]!==void 0){var a=s[n]||0,o=i[n],l=Array.isArray(t[n]),h=Array.isArray(o),c=!l&&h;c?t[n]=this._interpolationFunction(o,r):typeof o=="object"&&o?this._updateProperties(t[n],a,o,r):(o=this._handleRelativeValue(a,o),typeof o=="number"&&(t[n]=a+(o-a)*r))}},e.prototype._handleRelativeValue=function(t,s){return typeof s!="string"?s:s.charAt(0)==="+"||s.charAt(0)==="-"?t+parseFloat(s):parseFloat(s)},e.prototype._swapEndStartRepeatValues=function(t){var s=this._valuesStartRepeat[t],i=this._valuesEnd[t];typeof i=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(i):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=s},e}(),rt=ys;rt.getAll.bind(rt);rt.removeAll.bind(rt);rt.add.bind(rt);rt.remove.bind(rt);rt.update.bind(rt);class Je extends he{constructor(s){super(s);g(this,"displayName","Dynamic");g(this,"timeout",1e4);g(this,"tweens",new ce);this.bonusPicker.setProbabilities([[T.ExtraScore,20],[T.ExtraStrength,20],[T.PaddleIncrease,20],[T.PaddleDecrease,40]])}apply(){console.info("Dynamic mode activated"),this.game.balls.setStrength(2),this.tweens.clear(),this.timers.push(setInterval(()=>{if(this.game.state.isStarted)for(const s of this.game.bricks){const i=new Ji(s.pos);i.to({y:s.pos.y-1},500),i.easing(kt.Bounce.Out),i.start(),this.tweens.add(i)}},this.timeout))}async update(){await super.update();for(const s of this.tweens)s.update()}}class Qe extends he{constructor(){super(...arguments);g(this,"displayName","Classic")}apply(){if(console.info("Classic mode activated"),this.game.bricks.areEmpty())throw new Error("No bricks to iterate");this.game.balls.setStrength(1);for(const s of this.game.bricks)s.setStrength(1)}}class ts extends he{constructor(s){super(s);g(this,"displayName","Bonus");g(this,"timeout",3e3);g(this,"tweens",new ce);this.bonusPicker.setProbabilities([[T.DoubleBalls,10],[T.TripleBalls,10],[T.ExtraBalls,30],[T.ExtraScore,30],[T.ExtraWall,20]])}apply(){console.info("Bonus mode activated"),Ms(30),this.game.balls.setStrength(9),this.tweens.clear(),this.timers.push(setInterval(()=>{if(this.game.state.isStarted)for(const s of this.game.bricks){const i=new Ji(s.pos);i.to({y:s.pos.y-1},900),i.easing(kt.Bounce.Out),i.start(),this.tweens.add(i)}},this.timeout))}async update(){await super.update();for(const s of this.tweens)s.update()}}class es extends he{constructor(s){super(s);g(this,"displayName","Modern");this.bonusPicker.setProbabilities([[T.DoubleBalls,5],[T.TripleBalls,5],[T.ExtraBalls,15],[T.ExtraScore,15],[T.ExtraWall,10],[T.ExtraStrength,20],[T.PaddleDecrease,15],[T.PaddleIncrease,15]])}apply(){this.game.balls.setStrength(3),console.info("Modern mode activated")}}class c0 extends he{constructor(){super(...arguments);g(this,"displayName","Empty")}apply(){}}class h0{constructor(t){g(this,"modes");g(this,"currentMode");g(this,"previousMode",null);this.modes={[L.Empty]:new c0(t),[L.Dynamic]:new Je(t),[L.Classic]:new Qe(t),[L.Bonus]:new ts(t),[L.Modern]:new es(t)},this.currentMode=this.modes[L.Empty]}toString(){return this.currentMode.displayName}execute(t){this.clearTimers(),this.previousMode=this.currentMode,this.currentMode=this.modes[t],this.currentMode.apply()}async update(){await this.currentMode.update()}toggleBonus(){if(this.modeIsBonus())return this.restorePreviousMode();this.execute(L.Bonus),zt(L.Bonus)}restorePreviousMode(){this.clearTimers(),this.previousMode&&(this.previousMode instanceof Qe?zt(L.Classic):this.previousMode instanceof es?zt(L.Modern):this.previousMode instanceof Je&&zt(L.Dynamic),this.currentMode=this.previousMode,this.currentMode.apply())}setDefault(){this.execute(L.Dynamic)}isDynamic(){return this.currentMode instanceof Je}isClassic(){return this.currentMode instanceof Qe}modeIsBonus(){return this.currentMode instanceof ts}isModern(){return this.currentMode instanceof es}isBonus(){return this.currentMode instanceof ts}pickBonusType(){return this.currentMode.pickBonus()}clearTimers(){this.currentMode.clearTimers()}}class J{constructor(t){this.game=t}async attach(){console.group(`${this.constructor.name} state`),console.debug("Attached")}async detach(){console.debug("Detached"),console.groupEnd()}update(t){}}class Qi extends J{constructor(s){super(s);g(this,"timer",null);this.onBonusCollected=this.onBonusCollected.bind(this),this.onBrickDestroyed=this.onBrickDestroyed.bind(this)}async attach(){await super.attach(),this.startCountdown(),this.game.bonus.resume(),this.game.balls.resume(),v.on("bonusCollected",this.onBonusCollected),v.on("brickDestroyed",this.onBrickDestroyed),!this.game.balls.hasValue()&&this.game.lives.hasValue()&&(Ee.GameStart.play(),this.game.balls.spawnOneAt(V))}async detach(){this.game.bonus.stop(),this.game.balls.stop(),this.game.mode.clearTimers(),this.stopCountdown(),v.off("bonusCollected",this.onBonusCollected),v.off("brickDestroyed",this.onBrickDestroyed),await super.detach()}async update(s){if(this.game.balls.update(),await this.evaluateBonusModeEnd(),this.game.balls.escaped())return this.game.mode.isBonus()?await this.game.state.changeTo("stageWinDialog"):(this.game.balls.destroy(),this.game.lives.decrement(),this.game.lives.runOut()?await this.game.state.changeTo("extraLifeDialog"):await this.game.state.changeTo("idle"));if(this.game.stage.isCleared())return await this.game.state.changeTo("stageWinDialog")}onBonusCollected(s){this.game.bonus.collect(s)}onBrickDestroyed(s){this.game.score.add(s.score),s.isBreakable&&this.game.bricks.destroyed.increment(),!this.game.mode.isClassic()&&this.game.score.toValue()%3===0&&this.game.bonus.produce(this.game.mode.pickBonusType())}async evaluateBonusModeEnd(){this.game.mode.modeIsBonus()&&Ps()<=0&&await this.game.state.changeTo("stageWinDialog")}startCountdown(){this.game.mode.modeIsBonus()&&(this.timer=setInterval(()=>{Ms(s=>s-1)},1e3))}stopCountdown(){this.timer&&(clearInterval(this.timer),this.timer=null)}}class tn extends J{}class en extends J{async attach(){await super.attach(),this.game.stage.restart(),this.game.balls.destroy(),this.game.bonus.destroy(),this.game.lives.restore()}async detach(){await super.detach()}async update(t){(ws(0)||vs(0))&&await this.game.state.changeTo("started"),this.game.stage.showCurrentStageText(),this.game.stage.showClickToStartText()}}class sn extends J{async attach(){await super.attach()}async detach(){await super.detach()}async update(t){(ws(0)||vs(0))&&await this.game.state.changeTo("started"),this.game.stage.showClickToStartText()}}class nn extends J{async attach(){await super.attach();try{await this.game.ads.showRewardAd(),console.info("Ad finished"),await this.rewardPlayer(),await this.game.state.changeTo("idle")}catch(t){console.warn("Ad error",t),await this.game.state.changeTo("gameOver")}}async detach(){await super.detach()}async rewardPlayer(){this.game.lives.increment()}}let rn=class extends J{constructor(t){super(t),this.handleStartClick=this.handleStartClick.bind(this)}async attach(){await super.attach(),this.game.bonus.stop(),fs(!0),v.on("startClick",this.handleStartClick)}async detach(){fs(!1),v.off("startClick",this.handleStartClick),await super.detach()}async handleStartClick(){this.game.mode.execute(Ut()),this.game.stage.execute(He()),this.game.balls.destroy(),this.game.bonus.destroy(),this.game.bricks.destroy(),this.game.lives.restore(),this.game.bricks.populate(),this.game.state.previous.isExtraLifeDialog&&this.game.score.reset(),await this.game.state.changeTo("idle")}};class an extends J{constructor(t){super(t),this.handleDoubleWin=this.handleDoubleWin.bind(this),this.handleNextStage=this.handleNextStage.bind(this),this.handleRestart=this.handleRestart.bind(this)}async attach(){await super.attach(),Le.isCrazyGames()&&await window.CrazyGames.SDK.game.happytime(),gs(!0),v.on("doubleWin",this.handleDoubleWin),v.on("nextStage",this.handleNextStage),v.on("restartStage",this.handleRestart)}async detach(){gs(!1),v.off("doubleWin",this.handleDoubleWin),v.off("nextStage",this.handleNextStage),v.off("restartStage",this.handleRestart),await super.detach()}async handleDoubleWin(){await this.game.state.changeTo("adBreakDoubleScore")}async handleNextStage(){await this.game.state.changeTo("nextStage")}async handleRestart(){await this.game.state.changeTo("restarted")}}class ms extends J{}let on=class extends J{constructor(t){super(t),this.handleGetExtraLife=this.handleGetExtraLife.bind(this)}async attach(){await super.attach(),ps(!0),v.on("getExtraLife",this.handleGetExtraLife)}async detach(){ps(!1),v.off("getExtraLife",this.handleGetExtraLife),await super.detach()}async handleGetExtraLife(t){if(t)return await this.game.state.changeTo("adBreakExtraLife");await this.game.state.changeTo("gameOver")}};class ln extends J{async attach(){await super.attach(),this.game.balls.destroy(),this.game.bonus.destroy(),this.game.stage.next()}async detach(){await super.detach()}async update(t){(ws(0)||vs(0))&&await this.game.state.changeTo("started"),this.game.stage.showCurrentStageText(),this.game.stage.showClickToStartText()}}class ni{constructor(t){this.state=t}get isPaused(){return this.state instanceof tn}get isStarted(){return this.state instanceof Qi}get isIdle(){return this.state instanceof sn}get isGameOver(){return this.state instanceof rn}get isAdBreak(){return this.state instanceof nn}get isExtraLifeDialog(){return this.state instanceof on}get isStageWinDialog(){return this.state instanceof an}get isNextStage(){return this.state instanceof ln}get isRestarted(){return this.state instanceof en}get isInitial(){return this.state instanceof ms}get value(){return this.state}set value(t){this.state=t}}class u0 extends J{async attach(){await super.attach();try{await this.game.ads.showRewardAd(),console.info("Ad finished"),await this.rewardPlayer()}catch(t){console.warn("Ad error",t)}finally{await this.game.state.changeTo("nextStage")}}async detach(){await super.detach()}async rewardPlayer(){this.game.score.double()}}class d0 extends ni{constructor(s){super(new ms(s));g(this,"states");g(this,"previousState");this.states={initial:new ms(s),started:new Qi(s),paused:new tn(s),idle:new sn(s),restarted:new en(s),gameOver:new rn(s),nextStage:new ln(s),extraLifeDialog:new on(s),stageWinDialog:new an(s),adBreakExtraLife:new nn(s),adBreakDoubleScore:new u0(s)},this.state=this.states.initial,this.state.attach(),this.previousState=new ni(this.state)}get previous(){return this.previousState}async changeTo(s){this.previousState.value=this.state,await this.state.detach(),this.state=this.states[s],await this.state.attach()}update(s){this.state.update(s)}}class f0 extends Bs{constructor(t,s=d(2,1)){super(t,s),this.strength=16,this.tiles=this.getTileByIndex(1),this.color=Jr,this.tileIndex=Zr}get isBreakable(){return!1}setStrength(t){}get score(){return 0}increaseHitCount(){this.angle=M(-.01,.01),this.hitCount++}}class g0 extends Bs{constructor(t,s=d(2,1)){super(t,s)}get isBreakable(){return!0}}class p0{constructor(t){g(this,"destroyed");g(this,"bricks");g(this,"game");this.game=t,this.bricks=new ce,this.destroyed=new We(0,0,999)}populate(){for(const[t,s]of this.game.stage.current.getCoords()){if(t===Et.Unbreakable){this.bricks.add(new f0(s));continue}[Et.Normal,Et.Hard].includes(t)&&this.bricks.add(new g0(s))}}areEmpty(){return this.bricks.isEmpty()}destroy(){for(const t of this.bricks)t.destroy();this.bricks.clear(),this.destroyed.setVal(0)}*[Symbol.iterator](){for(const t of this.bricks)yield t}}class y0{constructor(){g(this,"coolDown",3e4);g(this,"enabled",!0);g(this,"timer",null);g(this,"timeLeft",0)}async showRewardAd(){if(this.enabled&&Le.isCrazyGames())return await window.CrazyGames.SDK.game.gameplayStop(),new Promise((t,s)=>{window.CrazyGames.SDK.ad.requestAd("rewarded",{adStarted:()=>console.info("Ad started"),adError:i=>s(i),adFinished:()=>(this.disableAdManager(),this.enableAdManager(),window.CrazyGames.SDK.game.gameplayStart().finally(t))})})}disableAdManager(){this.enabled=!1,ds(!0),this.timeLeft=this.coolDown/1e3,this.timer=setInterval(()=>{Wi(--this.timeLeft)},1e3)}enableAdManager(){setTimeout(()=>{this.enabled=!0,ds(!1),this.timer&&clearTimeout(this.timer)},this.coolDown)}}Tr(Ki.enabled());Pi(ne());Ki.disabled()&&Er(-1);class m0{constructor(){g(this,"lives");g(this,"score");g(this,"mode");g(this,"bonus");g(this,"stage");g(this,"state");g(this,"bricks");g(this,"ads");g(this,"balls");g(this,"paddle",null);g(this,"floor",null);this.init=this.init.bind(this),this.update=this.update.bind(this),this.postUpdate=this.postUpdate.bind(this),this.render=this.render.bind(this),this.postRender=this.postRender.bind(this),this.balls=new a0,this.score=new Fr(0),this.lives=new n0(3),this.bonus=new s0(this),this.stage=new i0(this),this.mode=new h0(this),this.state=new d0(this),this.bricks=new p0(this),this.ads=new y0}run(t,s){this.stage.execute(s),this.stage.start(),this.mode.execute(t),xr(this.init,this.update,this.postUpdate,this.render,this.postRender,Hr)}init(){Cr(new C(1280,720)),_r(j.scale(.5)),this.paddle=new Es(j),new Ce(d(-.5,j.y*.5),d(1,j.y)),new Ce(d(j.x+.5,j.y*.5),d(1,j.y)),new Ce(d(j.x*.5,j.y),d(j.x+2,1)),setTimeout(()=>this.state.changeTo("idle"))}update(){this.state.update(Ai)}async postUpdate(){await this.mode.update()}render(){vt(V,d(100,100),new y().setHex("#494746")),vt(V,j,new y().setHex("#ce9a80"))}postRender(){this.stage.showCounterText()}}console.info("Is development mode:",Le.isDevelopment());const cn=new m0;window.game=cn;window.store=jr;v.on("start",async()=>{cn.run(Ut(),He()),Le.isCrazyGames()&&await window.CrazyGames.SDK.game.gameplayStart()});const b0=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],w0=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...b0]),x0=new Set(["innerHTML","textContent","innerText","children"]),S0=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),v0=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function _0(e,t){const s=v0[e];return typeof s=="object"?s[t]?s.$:void 0:s}const C0=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),T0={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function E0(e,t,s){let i=s.length,r=t.length,n=i,a=0,o=0,l=t[r-1].nextSibling,h=null;for(;a<r||o<n;){if(t[a]===s[o]){a++,o++;continue}for(;t[r-1]===s[n-1];)r--,n--;if(r===a){const c=n<i?o?s[o-1].nextSibling:s[n-o]:l;for(;o<n;)e.insertBefore(s[o++],c)}else if(n===o)for(;a<r;)(!h||!h.has(t[a]))&&t[a].remove(),a++;else if(t[a]===s[n-1]&&s[o]===t[r-1]){const c=t[--r].nextSibling;e.insertBefore(s[o++],t[a++].nextSibling),e.insertBefore(s[--n],c),t[r]=s[n]}else{if(!h){h=new Map;let u=o;for(;u<n;)h.set(s[u],u++)}const c=h.get(t[a]);if(c!=null)if(o<c&&c<n){let u=a,f=1,m;for(;++u<r&&u<n&&!((m=h.get(t[u]))==null||m!==c+f);)f++;if(f>c-o){const b=t[a];for(;o<c;)e.insertBefore(s[o++],b)}else e.replaceChild(s[o++],t[a++])}else a++;else t[a++].remove()}}}const ri="_$DX_DELEGATE";function k0(e,t,s,i={}){let r;return Te(n=>{r=n,t===document?e():S(t,e(),t.firstChild?null:void 0,s)},i.owner),()=>{r(),t.textContent=""}}function G(e,t,s){let i;const r=()=>{const a=document.createElement("template");return a.innerHTML=e,s?a.content.firstChild.firstChild:a.content.firstChild},n=t?()=>At(()=>document.importNode(i||(i=r()),!0)):()=>(i||(i=r())).cloneNode(!0);return n.cloneNode=n,n}function ue(e,t=window.document){const s=t[ri]||(t[ri]=new Set);for(let i=0,r=e.length;i<r;i++){const n=e[i];s.has(n)||(s.add(n),t.addEventListener(n,I0))}}function Dt(e,t,s){s==null?e.removeAttribute(t):e.setAttribute(t,s)}function A0(e,t,s,i){i==null?e.removeAttributeNS(t,s):e.setAttributeNS(t,s,i)}function D0(e,t){t==null?e.removeAttribute("class"):e.className=t}function zs(e,t,s,i){if(i)Array.isArray(s)?(e[`$$${t}`]=s[0],e[`$$${t}Data`]=s[1]):e[`$$${t}`]=s;else if(Array.isArray(s)){const r=s[0];e.addEventListener(t,s[0]=n=>r.call(e,s[1],n))}else e.addEventListener(t,s)}function P0(e,t,s={}){const i=Object.keys(t||{}),r=Object.keys(s);let n,a;for(n=0,a=r.length;n<a;n++){const o=r[n];!o||o==="undefined"||t[o]||(ai(e,o,!1),delete s[o])}for(n=0,a=i.length;n<a;n++){const o=i[n],l=!!t[o];!o||o==="undefined"||s[o]===l||!l||(ai(e,o,!0),s[o]=l)}return s}function M0(e,t,s){if(!t)return s?Dt(e,"style"):t;const i=e.style;if(typeof t=="string")return i.cssText=t;typeof s=="string"&&(i.cssText=s=void 0),s||(s={}),t||(t={});let r,n;for(n in s)t[n]==null&&i.removeProperty(n),delete s[n];for(n in t)r=t[n],r!==s[n]&&(i.setProperty(n,r),s[n]=r);return s}function $0(e,t={},s,i){const r={};return i||H(()=>r.children=Ft(e,t.children,r.children)),H(()=>t.ref&&t.ref(e)),H(()=>O0(e,t,s,!0,r,!0)),r}function S(e,t,s,i){if(s!==void 0&&!i&&(i=[]),typeof t!="function")return Ft(e,t,i,s);H(r=>Ft(e,t(),r,s),i)}function O0(e,t,s,i,r={},n=!1){t||(t={});for(const a in r)if(!(a in t)){if(a==="children")continue;r[a]=oi(e,a,null,r[a],s,n)}for(const a in t){if(a==="children"){i||Ft(e,t.children);continue}const o=t[a];r[a]=oi(e,a,o,r[a],s,n)}}function B0(e){return e.toLowerCase().replace(/-([a-z])/g,(t,s)=>s.toUpperCase())}function ai(e,t,s){const i=t.trim().split(/\s+/);for(let r=0,n=i.length;r<n;r++)e.classList.toggle(i[r],s)}function oi(e,t,s,i,r,n){let a,o,l,h,c;if(t==="style")return M0(e,s,i);if(t==="classList")return P0(e,s,i);if(s===i)return i;if(t==="ref")n||s(e);else if(t.slice(0,3)==="on:"){const u=t.slice(3);i&&e.removeEventListener(u,i),s&&e.addEventListener(u,s)}else if(t.slice(0,10)==="oncapture:"){const u=t.slice(10);i&&e.removeEventListener(u,i,!0),s&&e.addEventListener(u,s,!0)}else if(t.slice(0,2)==="on"){const u=t.slice(2).toLowerCase(),f=C0.has(u);if(!f&&i){const m=Array.isArray(i)?i[0]:i;e.removeEventListener(u,m)}(f||s)&&(zs(e,u,s,f),f&&ue([u]))}else if(t.slice(0,5)==="attr:")Dt(e,t.slice(5),s);else if((c=t.slice(0,5)==="prop:")||(l=x0.has(t))||!r&&((h=_0(t,e.tagName))||(o=w0.has(t)))||(a=e.nodeName.includes("-")))c&&(t=t.slice(5),o=!0),t==="class"||t==="className"?D0(e,s):a&&!o&&!l?e[B0(t)]=s:e[h||t]=s;else{const u=r&&t.indexOf(":")>-1&&T0[t.split(":")[0]];u?A0(e,u,t,s):Dt(e,S0[t]||t,s)}return s}function I0(e){const t=`$$${e.type}`;let s=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==s&&Object.defineProperty(e,"target",{configurable:!0,value:s}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return s||document}});s;){const i=s[t];if(i&&!s.disabled){const r=s[`${t}Data`];if(r!==void 0?i.call(s,r,e):i.call(s,e),e.cancelBubble)return}s=s._$host||s.parentNode||s.host}}function Ft(e,t,s,i,r){for(;typeof s=="function";)s=s();if(t===s)return s;const n=typeof t,a=i!==void 0;if(e=a&&s[0]&&s[0].parentNode||e,n==="string"||n==="number")if(n==="number"&&(t=t.toString()),a){let o=s[0];o&&o.nodeType===3?o.data=t:o=document.createTextNode(t),s=Bt(e,s,i,o)}else s!==""&&typeof s=="string"?s=e.firstChild.data=t:s=e.textContent=t;else if(t==null||n==="boolean")s=Bt(e,s,i);else{if(n==="function")return H(()=>{let o=t();for(;typeof o=="function";)o=o();s=Ft(e,o,s,i)}),()=>s;if(Array.isArray(t)){const o=[],l=s&&Array.isArray(s);if(bs(o,t,s,r))return H(()=>s=Ft(e,o,s,i,!0)),()=>s;if(o.length===0){if(s=Bt(e,s,i),a)return s}else l?s.length===0?li(e,o,i):E0(e,s,o):(s&&Bt(e),li(e,o));s=o}else if(t.nodeType){if(Array.isArray(s)){if(a)return s=Bt(e,s,i,t);Bt(e,s,null,t)}else s==null||s===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);s=t}else console.warn("Unrecognized value. Skipped inserting",t)}return s}function bs(e,t,s,i){let r=!1;for(let n=0,a=t.length;n<a;n++){let o=t[n],l=s&&s[n],h;if(!(o==null||o===!0||o===!1))if((h=typeof o)=="object"&&o.nodeType)e.push(o);else if(Array.isArray(o))r=bs(e,o,l)||r;else if(h==="function")if(i){for(;typeof o=="function";)o=o();r=bs(e,Array.isArray(o)?o:[o],Array.isArray(l)?l:[l])||r}else e.push(o),r=!0;else{const c=String(o);l&&l.nodeType===3&&l.data===c?e.push(l):e.push(document.createTextNode(c))}}return r}function li(e,t,s=null){for(let i=0,r=t.length;i<r;i++)e.insertBefore(t[i],s)}function Bt(e,t,s,i){if(s===void 0)return e.textContent="";const r=i||document.createTextNode("");if(t.length){let n=!1;for(let a=t.length-1;a>=0;a--){const o=t[a];if(r!==o){const l=o.parentNode===e;!n&&!a?l?e.replaceChild(r,o):e.insertBefore(r,s):l&&o.remove()}else n=!0}}else e.insertBefore(r,s);return[r]}const z0=!1,L0=G('<section><fieldset><legend><b>Sound/Music</b></legend><div><input type="checkbox" id="sound"><label for="sound">Sound</label><input type="checkbox" id="music"><label for="music">Music'),hn=()=>{const e=({target:s})=>{const{checked:i}=s;ji(i),v.emit("sound",i)},t=()=>{Ui(!te()),v.emit("music",!te())};return(()=>{const s=L0(),i=s.firstChild,r=i.firstChild,n=r.nextSibling,a=n.firstChild,o=a.nextSibling,l=o.nextSibling;return a.addEventListener("change",e),l.addEventListener("change",t),H(()=>a.checked=ne()),H(()=>l.checked=te()),s})()},R0=G('<section class="modes"><fieldset><legend><b>Mode'),N0=G('<div class="mode"><input type="radio"><label>'),un=()=>{const e=[{name:"Classic",value:L.Classic},{name:"Dynamic",value:L.Dynamic},{name:"Modern",value:L.Modern}],t=s=>()=>{zt(s),v.emit("modeChange",s)};return(()=>{const s=R0(),i=s.firstChild;return i.firstChild,S(i,P(Ri,{each:e,children:r=>(()=>{const n=N0(),a=n.firstChild,o=a.nextSibling;return zs(a,"change",t(r.value)),S(o,()=>r.name),H(l=>{const h=r.name,c=r.name;return h!==l._v$&&Dt(a,"id",l._v$=h),c!==l._v$2&&Dt(o,"for",l._v$2=c),l},{_v$:void 0,_v$2:void 0}),H(()=>a.checked=Ut()===r.value),n})()}),null),s})()},j0=G('<section><fieldset><legend><b>Levels</b></legend><div class="levels">'),U0=G("<div>No items"),F0=G('<div class="level"><input type="radio" name="stage"><label>'),dn=()=>{const[e,t]=W(He()),s=i=>()=>{Ni(i),t(i),v.emit("stageChange",i)};return(()=>{const i=j0(),r=i.firstChild,n=r.firstChild,a=n.nextSibling;return S(a,P(Ri,{get each(){return Zi},get fallback(){return U0()},children:(o,l)=>(()=>{const h=F0(),c=h.firstChild,u=c.nextSibling;return zs(c,"change",s(l())),S(u,()=>o.name),H(f=>{const m=o.name,b=o.name;return m!==f._v$&&Dt(c,"id",f._v$=m),b!==f._v$2&&Dt(u,"for",f._v$2=b),f},{_v$:void 0,_v$2:void 0}),H(()=>c.checked=l()===e()),h})()})),i})()},H0=G("<div><div>Current Score: <b>"),W0=G("<fieldset><legend><b>Score</b></legend><div><div><div>High Score: <b>"),Ls=({highScoreOnly:e})=>(()=>{const t=W0(),s=t.firstChild,i=s.nextSibling,r=i.firstChild,n=r.firstChild,a=n.firstChild,o=a.nextSibling;return S(i,P(As,{when:!e,get children(){const l=H0(),h=l.firstChild,c=h.firstChild,u=c.nextSibling;return S(u,Fi),l}}),r),S(o,Hi),t})(),G0=G('<svg stroke-width="0"></svg>',2),V0=G("<title></title>",2);function Wt(e,t){const s=ei(e.a,t),[i,r]=Rr(s,["src"]);return(()=>{const n=G0.cloneNode(!0);return $0(n,ei({get stroke(){return e.a.stroke},get color(){return t.color||"currentColor"},get fill(){return t.color||"currentColor"},get style(){return{...t.style,overflow:"visible"}}},r,{get height(){return t.size||"1em"},get width(){return t.size||"1em"},get innerHTML(){return e.c},xmlns:"http://www.w3.org/2000/svg"}),!0,!0),S(n,()=>z0,null),S(n,(()=>{const a=ie(()=>!!t.title);return()=>a()&&(()=>{const o=V0.cloneNode(!0);return S(o,()=>t.title),o})()})(),null),n})()}function X0(e){return Wt({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path d="M10 2a2 2 0 0 1-1.5 1.937v5.087c.863.083 1.5.377 1.5.726 0 .414-.895.75-2 .75s-2-.336-2-.75c0-.35.637-.643 1.5-.726V3.937A2 2 0 1 1 10 2z"/><path d="M0 9.665v1.717a1 1 0 0 0 .553.894l6.553 3.277a2 2 0 0 0 1.788 0l6.553-3.277a1 1 0 0 0 .553-.894V9.665c0-.1-.06-.19-.152-.23L9.5 6.715v.993l5.227 2.178a.125.125 0 0 1 .001.23l-5.94 2.546a2 2 0 0 1-1.576 0l-5.94-2.546a.125.125 0 0 1 .001-.23L6.5 7.708l-.013-.988L.152 9.435a.25.25 0 0 0-.152.23z"/>'},e)}function K0(e){return Wt({a:{viewBox:"0 0 576 512"},c:'<path d="M413.5 237.5c-28.2 4.8-58.2-3.6-80-25.4L295.4 174c-15-15-23.4-35.2-23.4-56.4v-12.1L192.3 62c-5.3-2.9-8.6-8.6-8.3-14.7s3.9-11.5 9.5-14l47.2-21C259.1 4.2 279 0 299.2 0h18.1c36.7 0 72 14 98.7 39.1l44.6 42c24.2 22.8 33.2 55.7 26.6 86L503 183l8-8c9.4-9.4 24.6-9.4 33.9 0l24 24c9.4 9.4 9.4 24.6 0 33.9l-88 88c-9.4 9.4-24.6 9.4-33.9 0l-24-24c-9.4-9.4-9.4-24.6 0-33.9l8-8-17.5-17.5zM27.4 377.1l233.5-194.5c3.5 4.9 7.5 9.6 11.8 14l38.1 38.1c6 6 12.4 11.2 19.2 15.7L134.9 484.6C120.4 502 98.9 512 76.3 512 34.1 512 0 477.8 0 435.7c0-22.6 10.1-44.1 27.4-58.6z"/>'},e)}const Y0=G('<dialog><h2>Brick Breaker </h2><section class="actions"><button>Play '),q0=()=>{const[e,t]=W(!0),s=()=>{t(!1),v.emit("start")};return(()=>{const i=Y0(),r=i.firstChild;r.firstChild;const n=r.nextSibling,a=n.firstChild;return a.firstChild,S(r,P(K0,{}),null),S(i,P(Ls,{highScoreOnly:!0}),n),S(i,P(un,{}),n),S(i,P(dn,{}),n),S(i,P(hn,{}),n),a.$$click=s,S(a,P(X0,{size:"1.3em"}),null),H(()=>i.open=e()),i})()};ue(["click"]);const Z0=G('<dialog><h2>Game Over</h2><section class="actions"><button>Start'),J0=()=>{const e=()=>v.emit("startClick");return(()=>{const t=Z0(),s=t.firstChild,i=s.nextSibling,r=i.firstChild;return S(t,P(Ls,{}),i),S(t,P(un,{}),i),S(t,P(dn,{}),i),S(t,P(hn,{}),i),r.$$click=e,H(()=>t.open=Gi()),t})()};ue(["click"]);function fn(e){return Wt({a:{viewBox:"0 0 24 24"},c:'<path d="M4 8H2v12a2 2 0 0 0 2 2h12v-2H4z"/><path d="M20 2H8a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2zm-9 12V6l7 4z"/>'},e)}const Q0=G('<span class="timer">'),ta=G('<dialog><h2>Get extra life</h2><p>Watch a short Ad to get an extra chance to beat your high score.</p><section class="actions"><button>No, thanks</button><button>Watch Ad <!> '),ea=()=>{const e=()=>{v.emit("getExtraLife",!1)},t=()=>{v.emit("getExtraLife",!0)};return(()=>{const s=ta(),i=s.firstChild,r=i.nextSibling,n=r.nextSibling,a=n.firstChild,o=a.nextSibling,l=o.firstChild,h=l.nextSibling;return h.nextSibling,a.$$click=e,o.$$click=t,S(o,P(fn,{}),h),S(o,P(As,{get when(){return re()},get children(){const c=Q0();return S(c,()=>String(Ds()).padStart(2,"0")),c}}),null),H(c=>{const u=Xi(),f=re();return u!==c._v$&&(s.open=c._v$=u),f!==c._v$2&&(o.disabled=c._v$2=f),c},{_v$:void 0,_v$2:void 0}),s})()};ue(["click"]);function sa(e){return Wt({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-multiplier-2x",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 16l4 -4"/><path d="M18 16l-4 -4"/><path d="M6 10a2 2 0 1 1 4 0c0 .591 -.417 1.318 -.816 1.858l-3.184 4.143l4 0"/>'},e)}function ia(e){return Wt({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path fill-rule="evenodd" d="M12.75 8a4.5 4.5 0 0 1-8.61 1.834l-1.391.565A6.001 6.001 0 0 0 14.25 8 6 6 0 0 0 3.5 4.334V2.5H2v4l.75.75h3.5v-1.5H4.352A4.5 4.5 0 0 1 12.75 8z" clip-rule="evenodd"/>'},e)}function na(e){return Wt({a:{viewBox:"0 0 16 16"},c:'<path fill="currentColor" d="M12 2v12h-2V8.5l-5 5v-11l5 5V2z"/>'},e)}const ra=G('<span class="timer">'),aa=G('<dialog><h2>You win <span class="emoji">🎉</span></h2><section class="actions"><button>Double score</button><button>Restart </button><button>Next '),oa=()=>{const[e,t]=W(!1),s=()=>v.emit("doubleWin"),i=()=>v.emit("restartStage"),r=()=>v.emit("nextStage");return Dr(()=>{t(Ut()===L.Bonus)},[Ut()]),(()=>{const n=aa(),a=n.firstChild,o=a.nextSibling,l=o.firstChild;l.firstChild;const h=l.nextSibling;h.firstChild;const c=h.nextSibling;return c.firstChild,S(n,P(Ls,{}),o),l.$$click=s,S(l,P(sa,{}),null),S(l,P(fn,{}),null),S(l,P(As,{get when(){return re()},get children(){const u=ra();return S(u,()=>String(Ds()).padStart(2,"0")),u}}),null),h.$$click=i,S(h,P(ia,{}),null),c.$$click=r,S(c,P(na,{}),null),H(u=>{const f=Vi(),m=re(),b=e();return f!==u._v$&&(n.open=u._v$=f),m!==u._v$2&&(l.disabled=u._v$2=m),b!==u._v$3&&(h.disabled=u._v$3=b),u},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()};ue(["click"]);window.CrazyGames.SDK.game.sdkGameLoadingStart().then(()=>console.info("CrazyGames SDK loading started")).catch(e=>{console.error(`Error while loading CrazyGames SDK: ${e}`)});k0(()=>[P(q0,{}),P(J0,{}),P(oa,{}),P(ea,{})],document.body);window.CrazyGames.SDK.game.sdkGameLoadingStop().then(()=>console.info("CrazyGames SDK loading stopped")).catch(e=>{console.error(`Error while stopping CrazyGames SDK loading: ${e}`)});
//# sourceMappingURL=index-309a3958.js.map
